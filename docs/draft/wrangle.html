<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 1 Data Wrangling | Applied Data Skills</title>
<meta name="author" content="Emily Nordmann and Lisa DeBruine">
<meta name="description" content="1.1 Intended Learning Outcomes Be able to select and filter data for relevance Be able to create new columns and edit existing ones Be able to handle missing data library(tidyverse)  # data...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 1 Data Wrangling | Applied Data Skills">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/ads-v1/wrangle.html">
<meta property="og:image" content="https://psyteachr.github.io/ads-v1/images/logos/logo">
<meta property="og:description" content="1.1 Intended Learning Outcomes Be able to select and filter data for relevance Be able to create new columns and edit existing ones Be able to handle missing data library(tidyverse)  # data...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 1 Data Wrangling | Applied Data Skills">
<meta name="twitter:description" content="1.1 Intended Learning Outcomes Be able to select and filter data for relevance Be able to create new columns and edit existing ones Be able to handle missing data library(tidyverse)  # data...">
<meta name="twitter:image" content="https://psyteachr.github.io/ads-v1/images/logos/logo">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Processing &amp; Presenting Data">Applied Data Skills</a>:
        <small class="text-muted">Processing &amp; Presenting Data</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="active" href="wrangle.html"><span class="header-section-number">1</span> Data Wrangling</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/ads-v1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="wrangle" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Data Wrangling<a class="anchor" aria-label="anchor" href="#wrangle"><i class="fas fa-link"></i></a>
</h1>
<div class="incomplete-chapter">

</div>
<div id="ilo-wrangle" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Intended Learning Outcomes<a class="anchor" aria-label="anchor" href="#ilo-wrangle"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Be able to select and filter data for relevance</li>
<li>Be able to create new columns and edit existing ones</li>
<li>Be able to handle missing data</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>   <span class="co"># data wrangling functions</span></code></pre></div>
</div>
<div id="wrangling-functions" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Wrangling functions<a class="anchor" aria-label="anchor" href="#wrangling-functions"><i class="fas fa-link"></i></a>
</h2>
<p>Most <a class="glossary" target="_blank" title="The process of preparing data for visualisation and statistical analysis." href="https://psyteachr.github.io/glossary/d#data-wrangling">data wrangling</a> involves the reshaping functions you learned in Chapter <a href="#tidy"><strong>??</strong></a> and these six functions: <code>select</code>, <code>filter</code>, <code>arrange</code>, <code>mutate</code>, <code>summarise</code>, and <code>group_by</code>. You'll remember the last two from Chapter <a href="#summary"><strong>??</strong></a>, so we'll only cover them briefly.</p>
<p>We'll use a small example table with the sales and expenses for two years from four regions over two products.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/budget.csv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
sales_2019
</th>
<th style="text-align:right;">
sales_2020
</th>
<th style="text-align:right;">
expenses_2019
</th>
<th style="text-align:right;">
expenses_2020
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
9383
</td>
<td style="text-align:right;">
10722
</td>
<td style="text-align:right;">
9003
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5673
</td>
<td style="text-align:right;">
5027
</td>
<td style="text-align:right;">
5987
</td>
<td style="text-align:right;">
6065
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
11023
</td>
<td style="text-align:right;">
8450
</td>
<td style="text-align:right;">
10904
</td>
<td style="text-align:right;">
10572
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
6972
</td>
<td style="text-align:right;">
4005
</td>
<td style="text-align:right;">
4340
</td>
<td style="text-align:right;">
5150
</td>
</tr>
<tr>
<td style="text-align:left;">
East
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
9172
</td>
<td style="text-align:right;">
9849
</td>
<td style="text-align:right;">
9099
</td>
<td style="text-align:right;">
9558
</td>
</tr>
<tr>
<td style="text-align:left;">
East
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
4527
</td>
<td style="text-align:right;">
4596
</td>
<td style="text-align:right;">
5044
</td>
<td style="text-align:right;">
6986
</td>
</tr>
<tr>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
10533
</td>
<td style="text-align:right;">
10690
</td>
<td style="text-align:right;">
10683
</td>
<td style="text-align:right;">
9585
</td>
</tr>
<tr>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
6154
</td>
<td style="text-align:right;">
5376
</td>
<td style="text-align:right;">
5383
</td>
<td style="text-align:right;">
4814
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="select" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> Select<a class="anchor" aria-label="anchor" href="#select"><i class="fas fa-link"></i></a>
</h3>
<p>Select columns by name or number.</p>
<p>You can select each column individually, separated by commas (e.g., <code>region, sales_2019</code>). You can also select all columns from one to another by separating them with a colon (e.g., <code>sales_2019:expenses_2020</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget2020</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">sales_2020</span>, <span class="va">expenses_2020</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">budget2020</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "region"        "sales_2020"    "expenses_2020"</code></pre>
<p>You can select columns by number, which can be useful when the column names are long or complicated. You even rename them by setting <code>new_name = old_col</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regions</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span>`Sales Region` <span class="op">=</span> <span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Sales Region"  "sales_2019"    "sales_2020"    "expenses_2019"
## [5] "expenses_2020"</code></pre>
<p>You can use a minus symbol to un-select columns, leaving all of the other columns. If you want to exclude a span of columns, put parentheses around the span first, e.g., <code>-(sales_2019:expenses_2020)</code>, not <code>-sales_2019:expenses_2020</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sales</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">expenses_2019</span><span class="op">:</span><span class="va">expenses_2020</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "region"     "product"    "sales_2019" "sales_2020"</code></pre>
<p>You can select columns based on criteria about the column names.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>function</th>
<th>definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rdrr.io/pkg/tidyselect/man/starts_with.html">starts_with()</a></code></td>
<td>select columns that start with a character string</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/pkg/tidyselect/man/starts_with.html">ends_with()</a></code></td>
<td>elect columns that end with a character string</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/pkg/tidyselect/man/starts_with.html">contains()</a></code></td>
<td>select columns that contain a character string</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/pkg/tidyselect/man/starts_with.html">num_range()</a></code></td>
<td>select columns with a name that matches the pattern <code>prefix</code>
</td>
</tr>
</tbody>
</table></div>
<div class="info">
<p>Use <code>width</code> to set the number of digits with leading
zeros. For example, <code>num_range('var_', 8:10, width=2)</code> selects columns <code>var_08</code>, <code>var_09</code>, and <code>var_10</code>.</p>
</div>
<div class="try">
<p>What are the resulting columns for these four examples?</p>
<ul>
<li>
<code>budget %&gt;% select(starts_with("sales"))</code>
<select class="webex-select"><option value="blank"></option>
<option value="answer">sales_2019, sales_2020</option>
<option value="x">sales_2020, expenses_2020</option>
<option value="x">expenses_2019, expenses_2020</option>
<option value="x">sales_2019, sales_2020, expenses_2019, expenses_2020</option></select>
</li>
<li>
<code>budget %&gt;% select(ends_with("2020"))</code>
<select class="webex-select"><option value="blank"></option>
<option value="x">expenses_2019, expenses_2020</option>
<option value="answer">sales_2020, expenses_2020</option>
<option value="x">sales_2019, sales_2020</option>
<option value="x">sales_2019, sales_2020, expenses_2019, expenses_2020</option></select>
</li>
<li>
<code>budget %&gt;% select(contains("_"))</code>
<select class="webex-select"><option value="blank"></option>
<option value="answer">sales_2019, sales_2020, expenses_2019, expenses_2020</option>
<option value="x">sales_2019, sales_2020</option>
<option value="x">expenses_2019, expenses_2020</option>
<option value="x">sales_2020, expenses_2020</option></select>
</li>
<li>
<code>budget %&gt;% select(num_range("expenses_", 2019:2020))</code>
<select class="webex-select"><option value="blank"></option>
<option value="x">sales_2019, sales_2020, expenses_2019, expenses_2020</option>
<option value="answer">expenses_2019, expenses_2020</option>
<option value="x">sales_2019, sales_2020</option>
<option value="x">sales_2020, expenses_2020</option></select>
</li>
</ul>
</div>
</div>
<div id="filter" class="section level3" number="1.2.2">
<h3>
<span class="header-section-number">1.2.2</span> Filter<a class="anchor" aria-label="anchor" href="#filter"><i class="fas fa-link"></i></a>
</h3>
<p>Select rows by matching column criteria.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># select all rows from the North region</span>
<span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"North"</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
sales_2019
</th>
<th style="text-align:right;">
sales_2020
</th>
<th style="text-align:right;">
expenses_2019
</th>
<th style="text-align:right;">
expenses_2020
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
9383
</td>
<td style="text-align:right;">
10722
</td>
<td style="text-align:right;">
9003
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5673
</td>
<td style="text-align:right;">
5027
</td>
<td style="text-align:right;">
5987
</td>
<td style="text-align:right;">
6065
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="warning">
<p>Remember to use <code>==</code> and not <code>=</code> to check if two things are equivalent. A single <code>=</code> assigns the right-hand value to the left-hand variable.</p>
</div>
<p>You can select on multiple criteria by separating them with commas.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span>
  <span class="va">region</span> <span class="op">==</span> <span class="st">"North"</span>,
  <span class="va">product</span> <span class="op">==</span> <span class="st">"widgets"</span>
<span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
sales_2019
</th>
<th style="text-align:right;">
sales_2020
</th>
<th style="text-align:right;">
expenses_2019
</th>
<th style="text-align:right;">
expenses_2020
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
9383
</td>
<td style="text-align:right;">
10722
</td>
<td style="text-align:right;">
9003
</td>
</tr></tbody>
</table></div>
</div>
<p>You can use the symbols <code>&amp;</code>, <code>|</code>, and <code>!</code> to mean "and", "or", and "not". You can also use other operators to make equations. The equation is checked for each row, and if the result is FALSE, the row is removed.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># regions and products with profit in both 2019 and 2020</span>
<span class="va">profit_both</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span>
    <span class="va">sales_2019</span> <span class="op">&gt;</span> <span class="va">expenses_2019</span> <span class="op">&amp;</span>
    <span class="va">sales_2020</span> <span class="op">&gt;</span> <span class="va">expenses_2020</span>
  <span class="op">)</span>

<span class="co"># regions and products with profit in 2019 or 2020</span>
<span class="va">profit_either</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span>
    <span class="va">sales_2019</span> <span class="op">&gt;</span> <span class="va">expenses_2019</span> <span class="op">|</span>
    <span class="va">sales_2020</span> <span class="op">&gt;</span> <span class="va">expenses_2020</span>
  <span class="op">)</span>

<span class="co"># everything but the North</span>
<span class="va">not_north</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">!=</span> <span class="st">"North"</span><span class="op">)</span>

<span class="co"># 2020 profit greater than 1000</span>
<span class="va">profit_1000</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">sales_2020</span> <span class="op">-</span> <span class="va">expenses_2020</span> <span class="op">&gt;</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>The <a class="glossary" target="_blank" title="A binary operator (%in%) that returns a logical vector indicating if there is a match or not for its left operand." href="https://psyteachr.github.io/glossary/m#match-operator">match operator</a> (<code>%in%</code>) is useful here for testing if a column value is in a list.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"South"</span><span class="op">)</span>,
         <span class="va">product</span> <span class="op">==</span> <span class="st">"widgets"</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
sales_2019
</th>
<th style="text-align:right;">
sales_2020
</th>
<th style="text-align:right;">
expenses_2019
</th>
<th style="text-align:right;">
expenses_2020
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
9383
</td>
<td style="text-align:right;">
10722
</td>
<td style="text-align:right;">
9003
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
11023
</td>
<td style="text-align:right;">
8450
</td>
<td style="text-align:right;">
10904
</td>
<td style="text-align:right;">
10572
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="arrange" class="section level3" number="1.2.3">
<h3>
<span class="header-section-number">1.2.3</span> Arrange<a class="anchor" aria-label="anchor" href="#arrange"><i class="fas fa-link"></i></a>
</h3>
<p>Sort your dataset using <code><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange()</a></code>. You will find yourself needing to sort data in R much less than you do in Excel, since you don't need to have rows next to each other in order to, for example, calculate group means. But <code><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange()</a></code> can be useful when preparing data for display in tables. Reverse the order using <code><a href="https://rdrr.io/pkg/dplyr/man/desc.html">desc()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange</a></span><span class="op">(</span><span class="va">product</span>, <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/desc.html">desc</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
sales_2019
</th>
<th style="text-align:right;">
sales_2020
</th>
<th style="text-align:right;">
expenses_2019
</th>
<th style="text-align:right;">
expenses_2020
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
6154
</td>
<td style="text-align:right;">
5376
</td>
<td style="text-align:right;">
5383
</td>
<td style="text-align:right;">
4814
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
6972
</td>
<td style="text-align:right;">
4005
</td>
<td style="text-align:right;">
4340
</td>
<td style="text-align:right;">
5150
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5673
</td>
<td style="text-align:right;">
5027
</td>
<td style="text-align:right;">
5987
</td>
<td style="text-align:right;">
6065
</td>
</tr>
<tr>
<td style="text-align:left;">
East
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
4527
</td>
<td style="text-align:right;">
4596
</td>
<td style="text-align:right;">
5044
</td>
<td style="text-align:right;">
6986
</td>
</tr>
<tr>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
10533
</td>
<td style="text-align:right;">
10690
</td>
<td style="text-align:right;">
10683
</td>
<td style="text-align:right;">
9585
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
11023
</td>
<td style="text-align:right;">
8450
</td>
<td style="text-align:right;">
10904
</td>
<td style="text-align:right;">
10572
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
9383
</td>
<td style="text-align:right;">
10722
</td>
<td style="text-align:right;">
9003
</td>
</tr>
<tr>
<td style="text-align:left;">
East
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
9172
</td>
<td style="text-align:right;">
9849
</td>
<td style="text-align:right;">
9099
</td>
<td style="text-align:right;">
9558
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="try">
<p>If you want to sort categories in a specific order, turn the column into a <a class="glossary" target="_blank" title="A data type where a specific set of values are stored with labels; An explanatory variable manipulated by the experimenter" href="https://psyteachr.github.io/glossary/f#factor">factor</a> and set the <code>levels</code> in the desired order.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">region</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"South"</span>, <span class="st">"East"</span>, <span class="st">"West"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">product</span> <span class="op">==</span> <span class="st">"gadgets"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
sales_2019
</th>
<th style="text-align:right;">
sales_2020
</th>
<th style="text-align:right;">
expenses_2019
</th>
<th style="text-align:right;">
expenses_2020
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5673
</td>
<td style="text-align:right;">
5027
</td>
<td style="text-align:right;">
5987
</td>
<td style="text-align:right;">
6065
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
6972
</td>
<td style="text-align:right;">
4005
</td>
<td style="text-align:right;">
4340
</td>
<td style="text-align:right;">
5150
</td>
</tr>
<tr>
<td style="text-align:left;">
East
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
4527
</td>
<td style="text-align:right;">
4596
</td>
<td style="text-align:right;">
5044
</td>
<td style="text-align:right;">
6986
</td>
</tr>
<tr>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
6154
</td>
<td style="text-align:right;">
5376
</td>
<td style="text-align:right;">
5383
</td>
<td style="text-align:right;">
4814
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div id="mutate" class="section level3" number="1.2.4">
<h3>
<span class="header-section-number">1.2.4</span> Mutate<a class="anchor" aria-label="anchor" href="#mutate"><i class="fas fa-link"></i></a>
</h3>
<p>Add new columns or change existing ones. Refer to other columns by their names (unquoted). You can add more than one column in the same mutate function, just separate the columns with a comma. Once you make a new column, you can use it in further column definitions (e.g., <code>profit</code> below).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget2</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>
    sales <span class="op">=</span> <span class="va">sales_2019</span> <span class="op">+</span> <span class="va">sales_2020</span>,
    expenses <span class="op">=</span> <span class="va">expenses_2019</span> <span class="op">+</span> <span class="va">expenses_2020</span>,
    profit <span class="op">=</span> <span class="va">sales</span> <span class="op">-</span> <span class="va">expenses</span>,
    region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">region</span>, <span class="st">"Office"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="warning">
<p>You can overwrite a column by giving a new column the same name as the old column (see <code>region</code>) above. Make sure that you mean to do this and that you aren't trying to use the old column value after you redefine it.</p>
</div>
</div>
<div id="dplyr-summarise" class="section level3" number="1.2.5">
<h3>
<span class="header-section-number">1.2.5</span> Summarise<a class="anchor" aria-label="anchor" href="#dplyr-summarise"><i class="fas fa-link"></i></a>
</h3>
<p>You were introduced to the <code><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise()</a></code> function in Chapter @({#summary-summarise}). This applies summary functions to an entire table (or groups, as you'll see in the next section).</p>
<p>Let's say we want to determine the mean sales and expenses, plus the minimum and maximum profit, for any region, product and year. First, we need to reshape the data like we learned in Chapter <a href="#tidy"><strong>??</strong></a>, so that there is a column for year and one column each for sales and expenses, instead of separate columns for each year.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget3</span> <span class="op">&lt;-</span> <span class="va">budget</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">sales_2019</span><span class="op">:</span><span class="va">expenses_2020</span>,
               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span>, <span class="st">"year"</span><span class="op">)</span>,
               names_sep <span class="op">=</span> <span class="st">"_"</span>,
               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">type</span>,
              values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">budget3</span><span class="op">)</span> <span class="co"># check the format</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:right;">
sales
</th>
<th style="text-align:right;">
expenses
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
10722
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
9383
</td>
<td style="text-align:right;">
9003
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
5673
</td>
<td style="text-align:right;">
5987
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
5027
</td>
<td style="text-align:right;">
6065
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
11023
</td>
<td style="text-align:right;">
10904
</td>
</tr>
<tr>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
8450
</td>
<td style="text-align:right;">
10572
</td>
</tr>
</tbody>
</table></div>
</div>
<p>Now we can create summary statistics for the table.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget3</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise</a></span><span class="op">(</span>
    mean_sales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span>,
    mean_expenses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">expenses</span><span class="op">)</span>,
    min_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span><span class="op">)</span>,
    max_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
mean_sales
</th>
<th style="text-align:right;">
mean_expenses
</th>
<th style="text-align:right;">
min_profit
</th>
<th style="text-align:right;">
max_profit
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:right;">
7716.188
</td>
<td style="text-align:right;">
7743.438
</td>
<td style="text-align:right;">
-2632
</td>
<td style="text-align:right;">
2390
</td>
</tr></tbody>
</table></div>
</div>
</div>
<div id="dplyr-groupby" class="section level3" number="1.2.6">
<h3>
<span class="header-section-number">1.2.6</span> Group By<a class="anchor" aria-label="anchor" href="#dplyr-groupby"><i class="fas fa-link"></i></a>
</h3>
<p>You were introduced to the <code><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by()</a></code> function in Chapter <a href="#grouping"><strong>??</strong></a>. For example, you can break down the summary statistics above by year and product.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget3</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">product</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise</a></span><span class="op">(</span>
    mean_sales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span>,
    mean_expenses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">expenses</span><span class="op">)</span>,
    min_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span><span class="op">)</span>,
    max_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span><span class="op">)</span>,
    .groups <span class="op">=</span> <span class="st">"drop"</span>
  <span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
mean_sales
</th>
<th style="text-align:right;">
mean_expenses
</th>
<th style="text-align:right;">
min_profit
</th>
<th style="text-align:right;">
max_profit
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5831.50
</td>
<td style="text-align:right;">
5188.50
</td>
<td style="text-align:right;">
-2632
</td>
<td style="text-align:right;">
517
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
10689.25
</td>
<td style="text-align:right;">
10352.00
</td>
<td style="text-align:right;">
-1307
</td>
<td style="text-align:right;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
4751.00
</td>
<td style="text-align:right;">
5753.75
</td>
<td style="text-align:right;">
-562
</td>
<td style="text-align:right;">
2390
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
9593.00
</td>
<td style="text-align:right;">
9679.50
</td>
<td style="text-align:right;">
-1105
</td>
<td style="text-align:right;">
2122
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="try">
<p>How would you find out the maximum sales for each region?</p>
<div id="radio_VNOMSEDQHF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VNOMSEDQHF" value="x"><span>
<pre>budget3 %&gt;%
  group_by(sales) %&gt;%
  summarise(max_sales = max(region)</pre>
</span></label><label><input type="radio" autocomplete="off" name="radio_VNOMSEDQHF" value="x"><span>
<pre>budget3 %&gt;%
  group_by(region) %&gt;%
  summarise(max_sales = max(region)</pre>
</span></label><label><input type="radio" autocomplete="off" name="radio_VNOMSEDQHF" value="x"><span>
<pre>budget3 %&gt;%
  group_by(sales) %&gt;%
  summarise(max_sales = max(sales)</pre>
</span></label><label><input type="radio" autocomplete="off" name="radio_VNOMSEDQHF" value="answer"><span>
<pre>budget3 %&gt;%
  group_by(region) %&gt;%
  summarise(max_sales = max(sales)</pre>
</span></label>
</div>
</div>
</div>
</div>
<div id="missing-values" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Missing values<a class="anchor" aria-label="anchor" href="#missing-values"><i class="fas fa-link"></i></a>
</h2>
<p>What if the North region hasn't returned their sales data for 2020 yet?</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set sales values to NA for North 2020 rows</span>
<span class="va">budget_missing</span> <span class="op">&lt;-</span> <span class="va">budget3</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>sales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"North"</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span>, <span class="cn">NA</span>, <span class="va">sales</span><span class="op">)</span><span class="op">)</span>

<span class="co"># check</span>
<span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">budget_missing</span>, <span class="va">region</span> <span class="op">==</span> <span class="st">"North"</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:right;">
sales
</th>
<th style="text-align:right;">
expenses
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
12029
</td>
<td style="text-align:right;">
10722
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
9003
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
5673
</td>
<td style="text-align:right;">
5987
</td>
</tr>
<tr>
<td style="text-align:left;">
North
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6065
</td>
</tr>
</tbody>
</table></div>
</div>
<p>Now, if we try to calculate the mean sales and profits, we get missing values for any summary value that used one of the North 2020 sales values.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget_missing</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">product</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise</a></span><span class="op">(</span>
    mean_sales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span>,
    mean_expenses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">expenses</span><span class="op">)</span>,
    min_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span><span class="op">)</span>,
    max_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span><span class="op">)</span>,
    .groups <span class="op">=</span> <span class="st">"drop"</span>
  <span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
mean_sales
</th>
<th style="text-align:right;">
mean_expenses
</th>
<th style="text-align:right;">
min_profit
</th>
<th style="text-align:right;">
max_profit
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5831.50
</td>
<td style="text-align:right;">
5188.50
</td>
<td style="text-align:right;">
-2632
</td>
<td style="text-align:right;">
517
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
10689.25
</td>
<td style="text-align:right;">
10352.00
</td>
<td style="text-align:right;">
-1307
</td>
<td style="text-align:right;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5753.75
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
9679.50
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table></div>
</div>
<p>This is because <code>NA</code> basically means "I don't know", and the sum of 100 and "I don't know" is "I don't know", not 100. However, when you're calculating means, you often want to just ignore missing values. Set <code>na.rm = TRUE</code> in the summary function to remove missing values before calculating.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget_missing</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">product</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise</a></span><span class="op">(</span>
    mean_sales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sales</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    mean_expenses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">expenses</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    min_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    max_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">expenses</span> <span class="op">-</span> <span class="va">sales</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    .groups <span class="op">=</span> <span class="st">"drop"</span>
  <span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
mean_sales
</th>
<th style="text-align:right;">
mean_expenses
</th>
<th style="text-align:right;">
min_profit
</th>
<th style="text-align:right;">
max_profit
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
5831.50
</td>
<td style="text-align:right;">
5188.50
</td>
<td style="text-align:right;">
-2632
</td>
<td style="text-align:right;">
517
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
10689.25
</td>
<td style="text-align:right;">
10352.00
</td>
<td style="text-align:right;">
-1307
</td>
<td style="text-align:right;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
4659.00
</td>
<td style="text-align:right;">
5753.75
</td>
<td style="text-align:right;">
-562
</td>
<td style="text-align:right;">
2390
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
9663.00
</td>
<td style="text-align:right;">
9679.50
</td>
<td style="text-align:right;">
-1105
</td>
<td style="text-align:right;">
2122
</td>
</tr>
</tbody>
</table></div>
</div>
<p>If you want to find out how many missing or non-missing values there are in a column, use the <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> function to get a <a class="glossary" target="_blank" title="A data type representing TRUE or FALSE values." href="https://psyteachr.github.io/glossary/l#logical">logical</a> vector of whether or not each value is missing, and use <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> to count how many values are TRUE or <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> to calculate the proportion of TRUE values.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">budget_missing</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">product</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise</a></span><span class="op">(</span>
    n_valid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span><span class="op">)</span>,
    n_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span><span class="op">)</span>,
    prop_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span><span class="op">)</span>,
    .groups <span class="op">=</span> <span class="st">"drop"</span>
  <span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
product
</th>
<th style="text-align:right;">
n_valid
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
prop_missing
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
gadgets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:left;">
widgets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="together-wrangle" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Putting it together<a class="anchor" aria-label="anchor" href="#together-wrangle"><i class="fas fa-link"></i></a>
</h2>
<p>Load some demo data we first used in Chapter <a href="#data"><strong>??</strong></a>. Use <code><a href="https://rdrr.io/pkg/pillar/man/glimpse.html">glimpse()</a></code> or another method to get familiar with the data set.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># from https://www.kaggle.com/kyanyoga/sample-sales-data</span>
<span class="va">sales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/sales_data_sample.csv"</span>,
                  show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Double check that the <code>SALES</code> column does equal the <code>QUANTITYORDERED</code> column times the <code>PRICEEACH</code>. You can select just the columns you need and rename them when selecting to make the code more readable.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sales_check</span> <span class="op">&lt;-</span> <span class="va">sales</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">SALES</span>, n <span class="op">=</span> <span class="va">QUANTITYORDERED</span>, price <span class="op">=</span> <span class="va">PRICEEACH</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>total <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="va">price</span><span class="op">)</span></code></pre></div>
<p>Make a table of any rows where the value of <code>total</code> doesn't equal <code>SALES</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">sales_check</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">SALES</span> <span class="op">!=</span> <span class="va">total</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">errors</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
SALES
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:right;">
total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2765.90
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
81.35
</td>
<td style="text-align:right;">
2765.90
</td>
</tr>
<tr>
<td style="text-align:right;">
3884.34
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
94.74
</td>
<td style="text-align:right;">
3884.34
</td>
</tr>
<tr>
<td style="text-align:right;">
3746.70
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
83.26
</td>
<td style="text-align:right;">
3746.70
</td>
</tr>
<tr>
<td style="text-align:right;">
5205.27
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
100.00
</td>
<td style="text-align:right;">
4900.00
</td>
</tr>
<tr>
<td style="text-align:right;">
3479.76
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
96.66
</td>
<td style="text-align:right;">
3479.76
</td>
</tr>
<tr>
<td style="text-align:right;">
5512.32
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
100.00
</td>
<td style="text-align:right;">
4800.00
</td>
</tr>
</tbody>
</table></div>
</div>
<p>If you check the <code>errors</code> table, you'll see that 1697 of the original 2823 rows have "errors", even though many of the values in the <code>SALES</code> and <code>sales_check</code> columns look identical. You can fix this by rounding the value of <code>total</code> to 2 decimal places.</p>
<div class="info">
<p>This is due to the way values with decimal places are represented by a computer. You use base 10 to count, and have to represent some numbers with a repeating decimal, like 1/3 is .0333 repeating, while a computer uses binary to count, and has to represent different numbers using repeats. This can lead to very small differences when you divide or multiply some numbers.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="co"># avoids scientific notation</span>
<span class="va">x</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">49</span> <span class="op">*</span> <span class="fl">49</span><span class="op">)</span>
<span class="va">x</span> <span class="co"># prints as 1</span>
<span class="fl">1</span><span class="op">-</span><span class="va">x</span> <span class="co"># but is actually very slightly smaller</span></code></pre></div>
<pre><code>## [1] 1
## [1] 0.0000000000000001110223</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">sales_check</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">SALES</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">total</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>There are still 1304 errors! Lets look at the 10 smallest. We can do this by calculating the difference, arranging from smallest to largest, and filtering for the first 10 rows.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errors</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">SALES</span> <span class="op">-</span> <span class="va">total</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>Alternatively, we can use a <code>slice</code> function.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errors</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">SALES</span> <span class="op">-</span> <span class="va">total</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/slice.html">slice_min</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">diff</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
SALES
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:right;">
total
</th>
<th style="text-align:right;">
diff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2600.26
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2600
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:right;">
3602.16
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
3600
</td>
<td style="text-align:right;">
2.16
</td>
</tr>
<tr>
<td style="text-align:right;">
2504.75
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2500
</td>
<td style="text-align:right;">
4.75
</td>
</tr>
<tr>
<td style="text-align:right;">
4607.36
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
4600
</td>
<td style="text-align:right;">
7.36
</td>
</tr>
<tr>
<td style="text-align:right;">
3711.10
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
3700
</td>
<td style="text-align:right;">
11.10
</td>
</tr>
<tr>
<td style="text-align:right;">
3912.09
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
3900
</td>
<td style="text-align:right;">
12.09
</td>
</tr>
<tr>
<td style="text-align:right;">
2612.48
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2600
</td>
<td style="text-align:right;">
12.48
</td>
</tr>
<tr>
<td style="text-align:right;">
4613.80
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
4600
</td>
<td style="text-align:right;">
13.80
</td>
</tr>
<tr>
<td style="text-align:right;">
4814.40
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
4800
</td>
<td style="text-align:right;">
14.40
</td>
</tr>
<tr>
<td style="text-align:right;">
2915.66
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2900
</td>
<td style="text-align:right;">
15.66
</td>
</tr>
</tbody>
</table></div>
</div>
<p>If we plot the data, it looks like all of the errors are in one direction.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">errors</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SALES</span>, y <span class="op">=</span> <span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-wrangle_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Let's have a look at the data separately for products with a price of exactly 100 versus other products.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sales_check</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>price100 <span class="op">=</span> <span class="va">price</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SALES</span>, y <span class="op">=</span> <span class="va">total</span>, color <span class="op">=</span> <span class="va">price100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-wrangle_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>It looks like that's the problem with this dataset: the <code>PRICEEACH</code> column doesn't go above 100. Let's fix that by dividing the total sale price by the quantity ordered.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fixed_sales</span> <span class="op">&lt;-</span> <span class="va">sales</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>PRICEEACH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">SALES</span> <span class="op">/</span> <span class="va">QUANTITYORDERED</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now we can re-run the code from before to find any errors. We're adding in the <code>ORDERNUMBER</code> for the next step.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sales_check</span> <span class="op">&lt;-</span> <span class="va">fixed_sales</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">ORDERNUMBER</span>, 
         <span class="va">SALES</span>, 
         n <span class="op">=</span> <span class="va">QUANTITYORDERED</span>, 
         price <span class="op">=</span> <span class="va">PRICEEACH</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>total <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="va">price</span><span class="op">)</span>

<span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">sales_check</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">SALES</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">total</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">errors</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
ORDERNUMBER
</th>
<th style="text-align:right;">
SALES
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
price
</th>
<th style="text-align:right;">
total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
10304
</td>
<td style="text-align:right;">
10172.7
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
216.44
</td>
<td style="text-align:right;">
10172.68
</td>
</tr>
<tr>
<td style="text-align:right;">
10312
</td>
<td style="text-align:right;">
11623.7
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
242.16
</td>
<td style="text-align:right;">
11623.68
</td>
</tr>
<tr>
<td style="text-align:right;">
10405
</td>
<td style="text-align:right;">
11739.7
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
154.47
</td>
<td style="text-align:right;">
11739.72
</td>
</tr>
<tr>
<td style="text-align:right;">
10375
</td>
<td style="text-align:right;">
10039.6
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
233.48
</td>
<td style="text-align:right;">
10039.64
</td>
</tr>
<tr>
<td style="text-align:right;">
10388
</td>
<td style="text-align:right;">
10066.6
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
218.84
</td>
<td style="text-align:right;">
10066.64
</td>
</tr>
</tbody>
</table></div>
</div>
<p>There are 5 instances where the quantity ordered doesn't divide into the total price in a way that produces prices that round to the nearest cent. These might require further investigation, but let's just set the value of <code>SALES</code> to missing for the orders in the <code>errors</code> tables.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fixed_sales</span> <span class="op">&lt;-</span> <span class="va">fixed_sales</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>SALES <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
    test <span class="op">=</span> <span class="va">ORDERNUMBER</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">errors</span><span class="op">$</span><span class="va">ORDERNUMBER</span>,
    yes <span class="op">=</span> <span class="cn">NA</span>,
    no <span class="op">=</span> <span class="va">SALES</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>Now that you've fixed (most of) the problems with the dataset, see if you can figure out how to make the table below. It should take you 5 steps.</p>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
PRODUCTLINE
</th>
<th style="text-align:right;">
2003
</th>
<th style="text-align:right;">
2004
</th>
<th style="text-align:right;">
2005
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Planes
</td>
<td style="text-align:right;">
272258
</td>
<td style="text-align:right;">
502672
</td>
<td style="text-align:right;">
159051
</td>
</tr>
<tr>
<td style="text-align:left;">
Ships
</td>
<td style="text-align:right;">
244821
</td>
<td style="text-align:right;">
341438
</td>
<td style="text-align:right;">
128178
</td>
</tr>
<tr>
<td style="text-align:left;">
Trains
</td>
<td style="text-align:right;">
72802
</td>
<td style="text-align:right;">
116524
</td>
<td style="text-align:right;">
36917
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fixed_sales</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">PRODUCTLINE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Planes"</span>, <span class="st">"Ships"</span>, <span class="st">"Trains"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">YEAR_ID</span>, <span class="va">PRODUCTLINE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">SALES</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">YEAR_ID</span>,
              values_from <span class="op">=</span> <span class="va">total</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="exercises" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises"><i class="fas fa-link"></i></a>
</h2>
<div id="mutate-1" class="section level3" number="1.5.1">
<h3>
<span class="header-section-number">1.5.1</span> Mutate<a class="anchor" aria-label="anchor" href="#mutate-1"><i class="fas fa-link"></i></a>
</h3>
<p>Load some data about the <a href="https://psyteachr.github.io/ads-v1/data/scottish_population.csv">population of the Scottish counties</a>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scotpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/scottish_population.csv"</span>,
                    show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Transform the population value to the nearest thousands (e.g., 3433 would be "3K"), order from most to least populous, put the columns in the order <code>population</code> (in K) then <code>county</code>, and show only the counties with populations greater than 200K.</p>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
population
</th>
<th style="text-align:left;">
county
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
593K
</td>
<td style="text-align:left;">
Glasgow
</td>
</tr>
<tr>
<td style="text-align:left;">
486K
</td>
<td style="text-align:left;">
Edinburgh
</td>
</tr>
<tr>
<td style="text-align:left;">
365K
</td>
<td style="text-align:left;">
Fife
</td>
</tr>
<tr>
<td style="text-align:left;">
326K
</td>
<td style="text-align:left;">
North Lanarkshire
</td>
</tr>
<tr>
<td style="text-align:left;">
312K
</td>
<td style="text-align:left;">
South Lanarkshire
</td>
</tr>
<tr>
<td style="text-align:left;">
246K
</td>
<td style="text-align:left;">
Aberdeenshire
</td>
</tr>
<tr>
<td style="text-align:left;">
222K
</td>
<td style="text-align:left;">
Highland
</td>
</tr>
<tr>
<td style="text-align:left;">
217K
</td>
<td style="text-align:left;">
Aberdeen
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="try">
<p>There are several different ways you could make the table above. Some functions could be in a different order and some couldn't. See where you can move the <code><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter()</a></code> and <code><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange()</a></code> functions.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scotpop</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/desc.html">desc</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">population</span> <span class="op">&gt;</span> <span class="fl">200000</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>kpop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"K"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span>population <span class="op">=</span> <span class="va">kpop</span>, 
         county <span class="op">=</span> <span class="va">name</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div id="glossary-wrangle" class="section level2" number="1.6">
<h2>
<span class="header-section-number">1.6</span> Glossary<a class="anchor" aria-label="anchor" href="#glossary-wrangle"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
definition
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/d.html#data-wrangling" class="glossary" target="_blank">data wrangling</a>
</td>
<td style="text-align:left;">
The process of preparing data for visualisation and statistical analysis.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/f.html#factor" class="glossary" target="_blank">factor</a>
</td>
<td style="text-align:left;">
A data type where a specific set of values are stored with labels; An explanatory variable manipulated by the experimenter
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/l.html#logical" class="glossary" target="_blank">logical</a>
</td>
<td style="text-align:left;">
A data type representing TRUE or FALSE values.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/m.html#match-operator" class="glossary" target="_blank">match operator</a>
</td>
<td style="text-align:left;">
A binary operator (%in%) that returns a logical vector indicating if there is a match or not for its left operand.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="resources-wrangle" class="section level2" number="1.7">
<h2>
<span class="header-section-number">1.7</span> Further resources<a class="anchor" aria-label="anchor" href="#resources-wrangle"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf">Data transformation cheat sheet</a></li>
<li>
<a href="http://r4ds.had.co.nz/transform.html">Chapter 5: Data Transformation</a> in <em>R for Data Science</em>
</li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-R-base" class="csl-entry">
R Core Team. (2021). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>
</div>
</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><div class="chapter-nav">
<div class="prev"><a href="index.html">Overview</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#wrangle"><span class="header-section-number">1</span> Data Wrangling</a></li>
<li><a class="nav-link" href="#ilo-wrangle"><span class="header-section-number">1.1</span> Intended Learning Outcomes</a></li>
<li>
<a class="nav-link" href="#wrangling-functions"><span class="header-section-number">1.2</span> Wrangling functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#select"><span class="header-section-number">1.2.1</span> Select</a></li>
<li><a class="nav-link" href="#filter"><span class="header-section-number">1.2.2</span> Filter</a></li>
<li><a class="nav-link" href="#arrange"><span class="header-section-number">1.2.3</span> Arrange</a></li>
<li><a class="nav-link" href="#mutate"><span class="header-section-number">1.2.4</span> Mutate</a></li>
<li><a class="nav-link" href="#dplyr-summarise"><span class="header-section-number">1.2.5</span> Summarise</a></li>
<li><a class="nav-link" href="#dplyr-groupby"><span class="header-section-number">1.2.6</span> Group By</a></li>
</ul>
</li>
<li><a class="nav-link" href="#missing-values"><span class="header-section-number">1.3</span> Missing values</a></li>
<li><a class="nav-link" href="#together-wrangle"><span class="header-section-number">1.4</span> Putting it together</a></li>
<li>
<a class="nav-link" href="#exercises"><span class="header-section-number">1.5</span> Exercises</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#mutate-1"><span class="header-section-number">1.5.1</span> Mutate</a></li></ul>
</li>
<li><a class="nav-link" href="#glossary-wrangle"><span class="header-section-number">1.6</span> Glossary</a></li>
<li><a class="nav-link" href="#resources-wrangle"><span class="header-section-number">1.7</span> Further resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/ads-v1/blob/master/book/08-wrangle.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/ads-v1/edit/master/book/08-wrangle.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Applied Data Skills</strong>: Processing &amp; Presenting Data" was written by Emily Nordmann and Lisa DeBruine. It was last built on 2022-02-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
