<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Basic Data Visualisation | Applied Data Skills</title>
<meta name="author" content="Emily Nordmann and Lisa DeBruine">
<meta name="description" content="3.1 Intended Learning Outcomes Identify categorical versus continuous data Create plots in layers using ggplot Be able to choose appropriate plots for data library(tidyverse) # includes ggplot2...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Basic Data Visualisation | Applied Data Skills">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/ads-v1/viz.html">
<meta property="og:image" content="https://psyteachr.github.io/ads-v1/images/logos/logo">
<meta property="og:description" content="3.1 Intended Learning Outcomes Identify categorical versus continuous data Create plots in layers using ggplot Be able to choose appropriate plots for data library(tidyverse) # includes ggplot2...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Basic Data Visualisation | Applied Data Skills">
<meta name="twitter:description" content="3.1 Intended Learning Outcomes Identify categorical versus continuous data Create plots in layers using ggplot Be able to choose appropriate plots for data library(tidyverse) # includes ggplot2...">
<meta name="twitter:image" content="https://psyteachr.github.io/ads-v1/images/logos/logo">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Processing &amp; Presenting Data">Applied Data Skills</a>:
        <small class="text-muted">Processing &amp; Presenting Data</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Intro to R and RStudio</a></li>
<li><a class="" href="reports.html"><span class="header-section-number">2</span> Reports with R Markdown</a></li>
<li><a class="active" href="viz.html"><span class="header-section-number">3</span> Basic Data Visualisation</a></li>
<li><a class="" href="data.html"><span class="header-section-number">4</span> Data Import</a></li>
<li><a class="" href="joins.html"><span class="header-section-number">5</span> Data Relations</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">6</span> Data Tidying</a></li>
<li><a class="" href="wrangle.html"><span class="header-section-number">7</span> Data Wrangling</a></li>
<li><a class="" href="summary.html"><span class="header-section-number">8</span> Data Summaries</a></li>
<li><a class="" href="custom.html"><span class="header-section-number">9</span> Customising Visualisations</a></li>
<li><a class="" href="present.html"><span class="header-section-number">10</span> Advanced Reports</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="appendix-updating-r.html"><span class="header-section-number">B</span> Updating R, RStudio, and packages</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">C</span> Symbols</a></li>
<li><a class="" href="conventions.html"><span class="header-section-number">D</span> Conventions</a></li>
<li><a class="" href="data-types.html"><span class="header-section-number">E</span> Data Types</a></li>
<li><a class="" href="plotstyle.html"><span class="header-section-number">F</span> Styling Plots</a></li>
<li><a class="" href="twitter-example.html"><span class="header-section-number">G</span> Twitter Example</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/ads-v1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="viz" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Basic Data Visualisation<a class="anchor" aria-label="anchor" href="#viz"><i class="fas fa-link"></i></a>
</h1>
<div id="ilo-viz" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Intended Learning Outcomes<a class="anchor" aria-label="anchor" href="#ilo-viz"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Identify categorical versus continuous data</li>
<li>Create plots in layers using ggplot</li>
<li>Be able to choose appropriate plots for data</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># includes ggplot2</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span> <span class="co"># for multi-part plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>  <span class="co"># for plot themes</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span> <span class="co"># for manipulating dates</span></code></pre></div>
</div>
<div id="variable-types" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Variable Types<a class="anchor" aria-label="anchor" href="#variable-types"><i class="fas fa-link"></i></a>
</h2>
<p>If a spreadsheet is in a <code>r glossary("tidy data")</code> format, each row is an <a class="glossary" target="_blank" title="All of the data about a single trial or question." href="https://psyteachr.github.io/glossary/o#observation">observation</a>, each column is a <a class="glossary" target="_blank" title="A word that identifies and stores the value of some data for later use." href="https://psyteachr.github.io/glossary/v#variable">variable</a>, and the information in each cell is a <a class="glossary" target="_blank" title="A single number or piece of data." href="https://psyteachr.github.io/glossary/v#value">value</a>. We'll learn more about how to get our data into this format in Chapter <a href="tidy.html#tidy">6</a>, but to get started we'll use built-in datasets with the right format.</p>
<p>For example, the table below lists pets owned by members of the psyTeachR team. Each row is an observation of one pet. There are 6 variables for each pet, their <code>name</code>, <code>owner</code>, <code>species</code>, <code>birthdate</code>, <code>weight</code> (in kg), and <code>rating</code> (on a 5-point scale from "very evil" to "very good").</p>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
owner
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
birthdate
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:left;">
rating
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Darwin
</td>
<td style="text-align:left;">
Lisa
</td>
<td style="text-align:left;">
ferret
</td>
<td style="text-align:left;">
1998-04-02
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:left;">
a little evil
</td>
</tr>
<tr>
<td style="text-align:left;">
Oy
</td>
<td style="text-align:left;">
Lisa
</td>
<td style="text-align:left;">
ferret
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:left;">
very good
</td>
</tr>
<tr>
<td style="text-align:left;">
Khaleesi
</td>
<td style="text-align:left;">
Emily
</td>
<td style="text-align:left;">
cat
</td>
<td style="text-align:left;">
2014-10-01
</td>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:left;">
very good
</td>
</tr>
<tr>
<td style="text-align:left;">
Bernie
</td>
<td style="text-align:left;">
Phil
</td>
<td style="text-align:left;">
dog
</td>
<td style="text-align:left;">
2017-06-01
</td>
<td style="text-align:right;">
32.0
</td>
<td style="text-align:left;">
very good
</td>
</tr>
</tbody>
</table></div>
</div>
<p>Variables can be classified as <a class="glossary" target="_blank" title="Data that can take on any values between other existing values." href="https://psyteachr.github.io/glossary/c#continuous">continuous</a> (numbers) or <a class="glossary" target="_blank" title="Data that can only take certain values, such as types of pet." href="https://psyteachr.github.io/glossary/c#categorical">categorical</a> (labels). When you're plotting data, it's important to know what kind of variables you have, which can help you decide what types of plots are most appropriate. Each variable also has a <a class="glossary" target="_blank" title="The kind of data represented by an object." href="https://psyteachr.github.io/glossary/d#data-type">data type</a>, such as <a class="glossary" target="_blank" title="A data type representing a real decimal number or integer." href="https://psyteachr.github.io/glossary/n#numeric">numeric</a> (numbers), <a class="glossary" target="_blank" title="A data type representing strings of text." href="https://psyteachr.github.io/glossary/c#character">character</a> (text), or <a class="glossary" target="_blank" title="A data type representing TRUE or FALSE values." href="https://psyteachr.github.io/glossary/l#logical">logical</a> (TRUE/FALSE values). Some plots can only work on some data types. Appendix <a href="data-types.html#data-types">E</a> has more details, as this concept will be relevant repeatedly.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:excel-format-cells"></span>
<img src="images/appx/excel-format-cells.png" alt="Data types are like the categories when you format cells in Excel." width="100%"><p class="caption">
Figure 3.1: Data types are like the categories when you format cells in Excel.
</p>
</div>
<div id="continuous" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Continuous<a class="anchor" aria-label="anchor" href="#continuous"><i class="fas fa-link"></i></a>
</h3>
<p><a class="glossary" target="_blank" title="Data that can take on any values between other existing values." href="https://psyteachr.github.io/glossary/c#continuous">Continuous</a> variables are properties you can measure, like weight. You can use continuous variables in mathematical operations, like calculating the sum total of a column of prices or the average number of social media likes per day. They may be rounded to the nearest whole number, but it should make sense to have a measurement halfway between.</p>
<p>Continuous variables always have a <a class="glossary" target="_blank" title="A data type representing a real decimal number or integer." href="https://psyteachr.github.io/glossary/n#numeric">numeric</a> data type. They are either <a class="glossary" target="_blank" title="A data type representing whole numbers." href="https://psyteachr.github.io/glossary/i#integer">integers</a> like <code><span class="fl">42</span></code> or <a class="glossary" target="_blank" title="A data type representing a real decimal number" href="https://psyteachr.github.io/glossary/d#double">doubles</a> like <code><span class="fl">3.14159</span></code>.</p>
</div>
<div id="categorical" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Categorical<a class="anchor" aria-label="anchor" href="#categorical"><i class="fas fa-link"></i></a>
</h3>
<p><a class="glossary" target="_blank" title="Data that can only take certain values, such as types of pet." href="https://psyteachr.github.io/glossary/c#categorical">Categorical</a> variables are properties you can count, like the species of pet. Categorical variables can be <a class="glossary" target="_blank" title="Categorical variables that don't have an inherent order, such as types of animal." href="https://psyteachr.github.io/glossary/n#nominal">nominal</a>, where the categories don't really have an order, like cats, dogs and ferrets (even though ferrets are obviously best), or <a class="glossary" target="_blank" title="Discrete variables that have an inherent order, such as number of legs" href="https://psyteachr.github.io/glossary/o#ordinal">ordinal</a>, where they have a clear order but the distance between the categories isn't something you could exactly equate, like points on a <a class="glossary" target="_blank" title="A rating scale with a small number of discrete points in order" href="https://psyteachr.github.io/glossary/l#likert">Likert</a> rating scale. Even if a data table uses numbers like 1-7 to represent ordinal variables, you shouldn't treat them like continuous variables.</p>
<p>Categorical data can have a <a class="glossary" target="_blank" title="A data type representing strings of text." href="https://psyteachr.github.io/glossary/c#character">character</a> data type, also called <a class="glossary" target="_blank" title="A piece of text inside of quotes." href="https://psyteachr.github.io/glossary/s#string">strings</a>. These are made by putting text inside of quotes. That text can be letters, punctuation, or even numbers. For example, <code><span class="st">"January"</span></code> is a character string, but so is <code><span class="st">"1"</span></code> if you put it in quotes. The character data type is best for variables that can have a lot of different values that you can't predict ahead of time.</p>
<p>Categorical data can also be <a class="glossary" target="_blank" title="A data type where a specific set of values are stored with labels; An explanatory variable manipulated by the experimenter" href="https://psyteachr.github.io/glossary/f#factor">factors</a>, a specific type of integer that lets you specify the category names and their order. This is useful for making plots display with categories in the order you want (otherwise they default to alphabetical order). The factor data type is best for categories that have a specific number of levels.</p>
<p>Sometimes people represent categorical variables with numbers that correspond to names, like 0 = "no" and 1 = "yes", but values in between don't have a clear interpretation. If you have control over how the data are recorded, it's better to use the character names for clarity, but you'll learn how to recode columns in Chapter <a href="wrangle.html#wrangle">7</a>.</p>
</div>
<div id="dates-and-times" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Dates and Times<a class="anchor" aria-label="anchor" href="#dates-and-times"><i class="fas fa-link"></i></a>
</h3>
<p>Dates and times are a special case of variable. They can act like categorical or continuous variables, and there are special ways to plot them. Dates and times can be hard to work with, but the <code class="package"><a href="https://lubridate.tidyverse.org/" target="_blank">lubridate</a></code> package provides functions to help you with this.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/now.html">today</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/now.html">now</a></span><span class="op">(</span>tzone <span class="op">=</span> <span class="st">"GMT"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "2021-11-22"
## [1] "2021-11-22 14:39:14 GMT"</code></pre>
</div>
<div id="test-your-understanding" class="section level3" number="3.2.4">
<h3>
<span class="header-section-number">3.2.4</span> Test your understanding<a class="anchor" aria-label="anchor" href="#test-your-understanding"><i class="fas fa-link"></i></a>
</h3>
<p>Coming back to the pets dataset, what type of variable is in each column? You can use the function <code>glimpse()</code> to show a list of the column names, their data types, and the first few values in each column.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">glimpse</span><span class="op">(</span><span class="va">pets</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 4
## Columns: 6
## $ name      &lt;chr&gt; "Darwin", "Oy", "Khaleesi", "Bernie"
## $ owner     &lt;chr&gt; "Lisa", "Lisa", "Emily", "Phil"
## $ species   &lt;fct&gt; ferret, ferret, cat, dog
## $ birthdate &lt;date&gt; 1998-04-02, NA, 2014-10-01, 2017-06-01
## $ weight    &lt;dbl&gt; 1.2, 2.9, 4.5, 32.0
## $ rating    &lt;fct&gt; a little evil, very good, very good, very good</code></pre>
<div class="try">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">Column</th>
<th align="left">Variable type</th>
<th align="left">Data type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>name</code></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">continuous</option>
<option value="answer">nominal</option>
<option value="x">ordinal</option>
<option value="x">date</option></select></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">numeric</option>
<option value="answer">character</option>
<option value="x">factor</option>
<option value="x">date</option></select></td>
</tr>
<tr class="even">
<td align="left"><code>owner</code></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">continuous</option>
<option value="answer">nominal</option>
<option value="x">ordinal</option>
<option value="x">date</option></select></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">numeric</option>
<option value="answer">character</option>
<option value="x">factor</option>
<option value="x">date</option></select></td>
</tr>
<tr class="odd">
<td align="left"><code>species</code></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">continuous</option>
<option value="answer">nominal</option>
<option value="x">ordinal</option>
<option value="x">date</option></select></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">numeric</option>
<option value="x">character</option>
<option value="answer">factor</option>
<option value="x">date</option></select></td>
</tr>
<tr class="even">
<td align="left"><code>birthdate</code></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">continuous</option>
<option value="x">nominal</option>
<option value="x">ordinal</option>
<option value="answer">date</option></select></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">continuous</option>
<option value="x">nominal</option>
<option value="x">ordinal</option>
<option value="answer">date</option></select></td>
</tr>
<tr class="odd">
<td align="left"><code>weight</code></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="answer">continuous</option>
<option value="x">nominal</option>
<option value="x">ordinal</option>
<option value="x">date</option></select></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="answer">numeric</option>
<option value="x">character</option>
<option value="x">factor</option>
<option value="x">date</option></select></td>
</tr>
<tr class="even">
<td align="left"><code>rating</code></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">continuous</option>
<option value="x">nominal</option>
<option value="answer">ordinal</option>
<option value="x">date</option></select></td>
<td align="left"><select class="webex-select"><option value="blank"></option>
<option value="x">numeric</option>
<option value="x">character</option>
<option value="answer">factor</option>
<option value="x">date</option></select></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div id="building-plots" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Building Plots<a class="anchor" aria-label="anchor" href="#building-plots"><i class="fas fa-link"></i></a>
</h2>
<div id="layered-plots" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Layered Plots<a class="anchor" aria-label="anchor" href="#layered-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Figure <a href="viz.html#fig:layers">3.2</a> displays the evolution of a simple scatterplot using this layered approach. First, the plot space is built (layer 1); the variables are specified (layer 2); the type of visualisation (known as a <code>geom</code>) that is desired for these variables is specified (layer 3) - in this case <code>geom_point()</code> is called to visualise individual data points; a second geom is added to include a line of best fit (layer 4), the axis labels are edited for readability (layer 5), and finally, a theme is applied to change the overall appearance of the plot (layer 6).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:layers"></span>
<img src="03-viz_files/figure-html/layers-1.png" alt="Evolution of a layered plot" width="100%"><p class="caption">
Figure 3.2: Evolution of a layered plot
</p>
</div>
<p>Importantly, each layer is independent and independently customisable. For example, the size, colour and position of each component can be adjusted, or one could, for example, remove the first geom (the data points) to only visualise the line of best fit, simply by removing the layer that draws the data points (Figure <a href="viz.html#fig:remove-layer">3.3</a>). The use of layers makes it easy to build up complex plots step-by-step, and to adapt or extend plots from existing code.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:remove-layer"></span>
<img src="03-viz_files/figure-html/remove-layer-1.png" alt="Plot with scatterplot layer removed." width="100%"><p class="caption">
Figure 3.3: Plot with scatterplot layer removed.
</p>
</div>
</div>
<div id="loading-data-1" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Loading Data<a class="anchor" aria-label="anchor" href="#loading-data-1"><i class="fas fa-link"></i></a>
</h3>
<p>Let's build up the plot above, layer by layer. First we need to get the data. We'll learn how to load data in Chapter <a href="data.html#data">4</a>, but you can copy the code below to create a data table object. The "column specification" tells you what each column is named and what type of data it is. The abbreviation "chr" is for <a class="glossary" target="_blank" title="A data type representing strings of text." href="https://psyteachr.github.io/glossary/c#character">character</a> columns, "dbl" is for <a class="glossary" target="_blank" title="A data type representing a real decimal number" href="https://psyteachr.github.io/glossary/d#double">double</a> columns, and "dttm" is a date/time column.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">survey_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/survey_data.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 707 Columns: 7</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr  (3): caller_id, employee_id, issue_category
## dbl  (3): wait_time, call_time, satisfaction
## dttm (1): call_start</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>This data is simulated data for a call centre customer satisfaction survey. The first thing you should do when you need to plot data is to get familiar with what all of the rows (observations) and columns (variables) mean. Sometimes this is obvious, and sometimes it requires help from the data provider. Here, each row represents one call to the centre.</p>
<ul>
<li>
<code>caller_id</code> is a unique ID for each caller</li>
<li>
<code>employee_id</code> is a unique ID for each employee taking calls</li>
<li>
<code>call_start</code> is the date and time that the call arrived</li>
<li>
<code>wait_time</code> is the number of seconds the caller had to wait</li>
<li>
<code>call_time</code> is the number of seconds the call lasted after the employee picked up</li>
<li>
<code>issue_category</code> is whether the issue was tech, sales, returns, other</li>
<li>
<code>satisfaction</code> is the customer satisfaction rating on a scale from 1 (very unsatisfied) to 5 (very satisfied)</li>
</ul>
<p>Unless you specify the column types, data importing functions will just guess the types and usually default to double for columns with numbers and character for columns with letters. Use the function <code><a href="https://rdrr.io/r/stats/spectrum.html">spec()</a></code> to find out all of the column types and edit them if needed.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html">spec</a></span><span class="op">(</span><span class="va">survey_data</span><span class="op">)</span></code></pre></div>
<pre><code>## cols(
##   caller_id = col_character(),
##   employee_id = col_character(),
##   call_start = col_datetime(format = ""),
##   wait_time = col_double(),
##   call_time = col_double(),
##   issue_category = col_character(),
##   satisfaction = col_double()
## )</code></pre>
<p>Let's set <code>issue_category</code> as a factor and set the order of the levels. After you update the column types, you have to re-import the data setting the <code>col_types</code> argument to the new column types.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># updated column types</span>
<span class="va">survey_col_types</span> <span class="op">&lt;-</span> <span class="fu">cols</span><span class="op">(</span>
  caller_id <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,
  employee_id <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,
  call_start <span class="op">=</span> <span class="fu">col_datetime</span><span class="op">(</span>format <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,
  wait_time <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,
  call_time <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,
  issue_category <span class="op">=</span> <span class="fu">col_factor</span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tech"</span>, <span class="st">"sales"</span>, <span class="st">"returns"</span>, <span class="st">"other"</span><span class="op">)</span><span class="op">)</span>,
  satisfaction <span class="op">=</span> <span class="fu">col_integer</span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># re-import data with correct column  types</span>
<span class="va">survey_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/survey_data.csv"</span>,
                        col_types <span class="op">=</span> <span class="va">survey_col_types</span><span class="op">)</span></code></pre></div>
</div>
<div id="plot-setup" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Plot setup<a class="anchor" aria-label="anchor" href="#plot-setup"><i class="fas fa-link"></i></a>
</h3>
<p>Every plot starts with the <code>ggplot()</code> function and a data table. If your data are not loaded or you have a typo in your code, this will give you an error message. It's best to check your plot after each step so you can figure out where errors are more easily.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-setup"></span>
<img src="03-viz_files/figure-html/build-plot-setup-1.png" alt="A blank ggplot." width="100%"><p class="caption">
Figure 3.4: A blank ggplot.
</p>
</div>
</div>
<div id="mapping" class="section level3" number="3.3.4">
<h3>
<span class="header-section-number">3.3.4</span> Mapping<a class="anchor" aria-label="anchor" href="#mapping"><i class="fas fa-link"></i></a>
</h3>
<p>The next <a class="glossary" target="_blank" title="A variable that provides input to a function." href="https://psyteachr.github.io/glossary/a#argument">argument</a> to <code>ggplot()</code> is the <code>mapping</code>. This tells the plot which columns in the data should be represented by different "aesthetics" of the plot, such as the x-axis, y-axis, line colour, object fill, or line style.</p>
<p>The <code>mapping</code> argument requires the result of an <code>aes()</code> function. We can define the mapping first and then use that <a class="glossary" target="_blank" title="A word that identifies and stores the value of some data for later use." href="https://psyteachr.github.io/glossary/o#object">object</a> in the <code>ggplot()</code> function. Set the arguments <code>x</code> and <code>y</code> to the names of the columns you want to be plotted on those axes. Here, we want to plot the wait time on the x-axis and the call time on the y-axis.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set up the mapping</span>
<span class="va">wait_vs_call</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span>, 
                    y <span class="op">=</span> <span class="va">call_time</span><span class="op">)</span>

<span class="co"># set up the plot</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-mapping"></span>
<img src="03-viz_files/figure-html/build-plot-mapping-1.png" alt="A blank plot with x- and y- axes mapped." width="100%"><p class="caption">
Figure 3.5: A blank plot with x- and y- axes mapped.
</p>
</div>
<div class="info">
<p>You will often see the two steps above (setting up the mapping and setting up the plot) combined like below. If you put arguments in the right order, you don't need to use their names, and you can put the <code>aes()</code> function directly in the second argument. Once you're very familiar with plotting, this shortcut will make sense, but we'll use the longer, clearer version to start.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">survey_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span>, y <span class="op">=</span> <span class="va">call_time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="geoms" class="section level3" number="3.3.5">
<h3>
<span class="header-section-number">3.3.5</span> Geoms<a class="anchor" aria-label="anchor" href="#geoms"><i class="fas fa-link"></i></a>
</h3>
<p>Now we can add our plot elements in layers. These are referred to as <a class="glossary" target="_blank" title="The geometric style in which data are displayed, such as boxplot, density, or histogram." href="https://psyteachr.github.io/glossary/g#geom">geoms</a> and their functions start with <code>geom_</code>. You <strong>add</strong> layers onto the base plot created by <code>ggplot()</code> with a plus (<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>).</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="co"># scatterplot</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-geoms"></span>
<img src="03-viz_files/figure-html/build-plot-geoms-1.png" alt="Adding a scatterplot with geom_point()." width="100%"><p class="caption">
Figure 3.6: Adding a scatterplot with geom_point().
</p>
</div>
<div class="warning">
<p>Somewhat annoyingly, the plus has to be on the end of the previous line, not at the start of the next line. If you do make this mistake, you will get the following error message.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span>
  <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="co"># scatterplot</span></code></pre></div>
<pre><code>## Error: Cannot use `+.gg()` with a single argument. Did you accidentally put + on a new line?</code></pre>
</div>
</div>
<div id="multiple-geoms" class="section level3" number="3.3.6">
<h3>
<span class="header-section-number">3.3.6</span> Multiple Geoms<a class="anchor" aria-label="anchor" href="#multiple-geoms"><i class="fas fa-link"></i></a>
</h3>
<p>You can add more than one geom. They display in the order you set them up. In the code below, we make two different plots and assign them to <a class="glossary" target="_blank" title="A word that identifies and stores the value of some data for later use." href="https://psyteachr.github.io/glossary/o#object">objects</a> that we can add together using the <code><a href="https://rdrr.io/pkg/patchwork/man/plot_layout.html">plot_layout()</a></code> function from the <code class="package">patchwork</code> package.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">point_first</span> <span class="op">&lt;-</span> 
  <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># scatterplot</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span><span class="op">)</span> <span class="co"># line of best fit</span>
  
<span class="va">line_first</span> <span class="op">&lt;-</span>
  <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span><span class="op">)</span> <span class="op">+</span> <span class="co"># line of best fit</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="co"># scatterplot</span>

<span class="co"># add plots together in 1 row</span>
<span class="va">point_first</span> <span class="op">+</span> <span class="va">line_first</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_layout.html">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-geom2"></span>
<img src="03-viz_files/figure-html/build-plot-geom2-1.png" alt="Points first versus line first." width="100%"><p class="caption">
Figure 3.7: Points first versus line first.
</p>
</div>
</div>
<div id="styling-geoms" class="section level3" number="3.3.7">
<h3>
<span class="header-section-number">3.3.7</span> Styling Geoms<a class="anchor" aria-label="anchor" href="#styling-geoms"><i class="fas fa-link"></i></a>
</h3>
<p>We should definitely put the line in front of the points, but the points are still a bit dark. If you want to change the overall style of a geom (not use it to represent different levels of a variable), you can set arguments inside the geom function. See Appendix <a href="plotstyle.html#plotstyle">F</a> for more information about the ways to style plot aesthetics.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dodgerblue"</span>, 
             alpha <span class="op">=</span> <span class="fl">0.2</span>,
             shape <span class="op">=</span> <span class="fl">18</span>,
             size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, 
              formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, <span class="co"># default value; avoids annoying message</span>
              colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span>,
              linetype <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-style"></span>
<img src="03-viz_files/figure-html/build-plot-style-1.png" alt="Changing geom styles." width="100%"><p class="caption">
Figure 3.8: Changing geom styles.
</p>
</div>
<div class="try">
<p>Play around with different values for the aesthetics above. Figure out what the default values are for <code>shape</code> and <code>size</code>.</p>
</div>
</div>
<div id="format-axes" class="section level3" number="3.3.8">
<h3>
<span class="header-section-number">3.3.8</span> Format Axes<a class="anchor" aria-label="anchor" href="#format-axes"><i class="fas fa-link"></i></a>
</h3>
<p>Now we need to make the axes look neater. There are several functions you can use to change the axis labels, but the most powerful ones are the <code>scale_</code> functions. You need to use a scale function that matches the data you're plotting on that axis. Both of the axes here are <a class="glossary" target="_blank" title="Data that can take on any values between other existing values." href="https://psyteachr.github.io/glossary/c#continuous">continuous</a>, so we'll use <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code>.</p>
<p>The <code>name</code> argument changes the axis label. The <code>breaks</code> argument sets the major units and needs a <a class="glossary" target="_blank" title="A type of data structure that collects values with the same data type, like T/F values, numbers, or strings." href="https://psyteachr.github.io/glossary/v#vector">vector</a> of possible values, which can extend beyond the range of the data (e.g., <code>wait time</code> only goes up to 350, but we can specify breaks up to 600 to make the maths easier). The <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> function creates a sequence of numbers <code>from</code> one <code>to</code> another <code>by</code> specified steps.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set the breaks</span>
<span class="va">x_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">600</span>, by <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="va">y_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">600</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dodgerblue"</span>, 
             alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, 
              formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, 
              colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Wait Time (seconds)"</span>, 
                     breaks <span class="op">=</span> <span class="va">x_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Call time (seconds)"</span>,
                     breaks <span class="op">=</span> <span class="va">y_breaks</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-axes"></span>
<img src="03-viz_files/figure-html/build-plot-axes-1.png" alt="Formatting plot axes with scale_ functions." width="100%"><p class="caption">
Figure 3.9: Formatting plot axes with scale_ functions.
</p>
</div>
<div class="try">
<p>Check the help for <code>?scale_x_continuous</code> to see how you would set the minor units or specify how many breaks you want instead.</p>
</div>
</div>
<div id="axis-limits" class="section level3" number="3.3.9">
<h3>
<span class="header-section-number">3.3.9</span> Axis Limits<a class="anchor" aria-label="anchor" href="#axis-limits"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to change the minimum and maximum values on an axis, use the <code>coord_cartesian()</code> function. Many plots make more sense if the minimum and maximum values represent the range of possible values, even if those values aren't present in the data. Here, wait and call times can't be less than 0 seconds, so we'll set the minimum values to 0 and the maximum values to the first breaks above the maximum values.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dodgerblue"</span>, 
             alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, 
              formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, 
              colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Wait Time (seconds)"</span>, 
                     breaks <span class="op">=</span> <span class="va">x_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Call time (seconds)"</span>,
                     breaks <span class="op">=</span> <span class="va">y_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span>, 
                  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-limits"></span>
<img src="03-viz_files/figure-html/build-plot-limits-1.png" alt="Changing the axis limits." width="100%"><p class="caption">
Figure 3.10: Changing the axis limits.
</p>
</div>
<div class="dangerous">
<p>You can also set the <code>limits</code> argument inside the <code>scale_</code> functions, but this actually removes any data that falls outside these limits, rather than cropping your plot, and this can change the appearance of certain types of plots like violin plots and density plots.</p>
</div>
</div>
<div id="themes" class="section level3" number="3.3.10">
<h3>
<span class="header-section-number">3.3.10</span> Themes<a class="anchor" aria-label="anchor" href="#themes"><i class="fas fa-link"></i></a>
</h3>
<p><code class="package">ggplot2</code> comes with several built-in themes, such as <code>theme_minimal()</code> and <code>theme_bw()</code>, but the <code class="package"><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" target="_blank">ggthemes</a></code> package provides even more themes that match different software, such as GoogleDocs or Stata, or publications, such as the Economist or the Wall Street Journal. Let's add the GoogleDocs theme, but change the font size to 11 with the <code>base_size</code> argument and change the font to "Times" with the <code>base_family</code> argument.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dodgerblue"</span>, 
             alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, 
              formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, 
              colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Wait Time (seconds)"</span>, 
                     breaks <span class="op">=</span> <span class="va">x_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Call time (seconds)"</span>,
                     breaks <span class="op">=</span> <span class="va">y_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span>, 
                  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_gdocs.html">theme_gdocs</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span>, base_family <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-theme"></span>
<img src="03-viz_files/figure-html/build-plot-theme-1.png" alt="Changing the theme." width="100%"><p class="caption">
Figure 3.11: Changing the theme.
</p>
</div>
<div class="warning">
<p>If you don't that the font "Times" on your computer, you'll get an error message. Try another font that you do have installed.</p>
</div>
</div>
<div id="theme-tweaks" class="section level3" number="3.3.11">
<h3>
<span class="header-section-number">3.3.11</span> Theme Tweaks<a class="anchor" aria-label="anchor" href="#theme-tweaks"><i class="fas fa-link"></i></a>
</h3>
<p>If you're still not quite happy with a theme, you can customise it even further with the <code>themes()</code> function. Check the help for this function to see all of the possible options. The most common thing you'll want to do is to remove an element entirely. You do this by setting the relevant argument to <code>element_blank()</code>. Below, we're getting rid of the x-axis line and the plot background, which removes the line around the plot.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_vs_call</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dodgerblue"</span>, 
             alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, 
              formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, 
              colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Wait Time (seconds)"</span>, 
                     breaks <span class="op">=</span> <span class="va">x_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Call time (seconds)"</span>,
                     breaks <span class="op">=</span> <span class="va">y_breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span>, 
                  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_gdocs.html">theme_gdocs</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span>, base_family <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.line.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        plot.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:build-plot-custom-theme"></span>
<img src="03-viz_files/figure-html/build-plot-custom-theme-1.png" alt="Customising the theme." width="100%"><p class="caption">
Figure 3.12: Customising the theme.
</p>
</div>
</div>
</div>
<div id="appropriate-plots" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Appropriate Plots<a class="anchor" aria-label="anchor" href="#appropriate-plots"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">ggplot2 cheat sheet</a> is a great resource to help you find plots appropriate to your data, based on how many variables you're plotting and what type they are. The examples below all use the same customer satisfaction data, but each plot communicates something different.</p>
<p>We don't expect you to memorise all of the plot types or the methods for customising them, but it will be helpful to try out the code in the examples below for yourself, changing values to test your understanding.</p>
<div id="counting-categories" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Counting Categories<a class="anchor" aria-label="anchor" href="#counting-categories"><i class="fas fa-link"></i></a>
</h3>
<div id="bar-plot" class="section level4" number="3.4.1.1">
<h4>
<span class="header-section-number">3.4.1.1</span> Bar Plot<a class="anchor" aria-label="anchor" href="#bar-plot"><i class="fas fa-link"></i></a>
</h4>
<p>If you want to count the number of things per category, you can use <code>geom_bar()</code>.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#set up mapping</span>
<span class="va">count_issues</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">issue_category</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">count_issues</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="try">
<p>You probably want to customise some things, like the colours, order of the columns, and their labels. Inspect the code below to figure out where these things change. The functions <code>scale_fill_manual()</code> and <code>scale_x_discrete()</code> are new, but work in the same way as the other <code>scale_</code> functions. You'll learn more about this in Chapter <a href="custom.html#custom">9</a>.</p>
<div class="webex-solution">
<button>
Code
</button>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># gives each issue a different colour</span>
<span class="va">count_issues</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">issue_category</span>,
                    fill <span class="op">=</span> <span class="va">issue_category</span><span class="op">)</span> 

<span class="co"># change the default order and colours</span>
<span class="va">new_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>tech <span class="op">=</span> <span class="st">"goldenrod"</span>, 
                returns <span class="op">=</span> <span class="st">"darkgreen"</span>, 
                sales <span class="op">=</span> <span class="st">"dodgerblue3"</span>, 
                other <span class="op">=</span> <span class="st">"purple3"</span><span class="op">)</span>
<span class="va">new_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tech"</span>, <span class="st">"returns"</span>, <span class="st">"sales"</span>, <span class="st">"other"</span><span class="op">)</span>
<span class="va">new_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Technical"</span>, <span class="st">"Returns"</span>, <span class="st">"Sales"</span>, <span class="st">"Other"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">count_issues</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_discrete</span><span class="op">(</span>
    name <span class="op">=</span> <span class="st">"Issue Category"</span>, <span class="co"># change axis title</span>
    limits <span class="op">=</span> <span class="va">new_order</span>, <span class="co"># change order</span>
    labels <span class="op">=</span> <span class="va">new_labels</span> <span class="co"># change labels</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values <span class="op">=</span> <span class="va">new_colors</span>, <span class="co"># change colours</span>
    guide <span class="op">=</span> <span class="st">"none"</span> <span class="co"># remove the legend</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="st">""</span>, <span class="co"># remove axis title</span>
    <span class="co"># remove the space above and below the y-axis</span>
    expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">350</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># minimum = 0, maximum = 350</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Number of issues per category"</span><span class="op">)</span> <span class="co"># add a title</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/custom-bar-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="column-plot" class="section level4" number="3.4.1.2">
<h4>
<span class="header-section-number">3.4.1.2</span> Column Plot<a class="anchor" aria-label="anchor" href="#column-plot"><i class="fas fa-link"></i></a>
</h4>
<p>If your data already have a column with the count you want to plot, you can use <code>geom_col()</code> to plot it. We can use the <code>count()</code> function to make a table with a row for each <code>issue_category</code> and a column called <code>n</code> with the number of observations in that category.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu">count</span><span class="op">(</span>x <span class="op">=</span> <span class="va">survey_data</span>, <span class="va">issue_category</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
issue_category
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
tech
</td>
<td style="text-align:right;">
311
</td>
</tr>
<tr>
<td style="text-align:left;">
sales
</td>
<td style="text-align:right;">
88
</td>
</tr>
<tr>
<td style="text-align:left;">
returns
</td>
<td style="text-align:right;">
232
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:right;">
76
</td>
</tr>
</tbody>
</table></div>
</div>
<p>The mapping for <code>geom_col()</code> requires you to set both the <code>x</code> and <code>y</code> aesthetics. Set <code>y = n</code> because we want to plot the number of issues in each category, and that information is in the column called <code>n</code>.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">count_mapping</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">issue_category</span>, 
                     y <span class="op">=</span> <span class="va">n</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">count_data</span>, mapping <span class="op">=</span> <span class="va">count_mapping</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="pie-chart" class="section level4" number="3.4.1.3">
<h4>
<span class="header-section-number">3.4.1.3</span> Pie Chart<a class="anchor" aria-label="anchor" href="#pie-chart"><i class="fas fa-link"></i></a>
</h4>
<p>Pie charts are a <a href="https://www.data-to-viz.com/caveat/pie.html" target="_blank">misleading form of data visualisation</a>, so we won't cover them. We'll cover options for visualising proportions, like lollipop and treemap plots, in Chapter <a href="custom.html#custom">9</a>.</p>
</div>
<div id="test-your-understanding-1" class="section level4" number="3.4.1.4">
<h4>
<span class="header-section-number">3.4.1.4</span> Test your understanding<a class="anchor" aria-label="anchor" href="#test-your-understanding-1"><i class="fas fa-link"></i></a>
</h4>
<p>Here is a small data table.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">country</th>
<th align="right">population</th>
<th align="left">island</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Northern Ireland</td>
<td align="right">1,895,510</td>
<td align="left">Ireland</td>
</tr>
<tr class="even">
<td align="left">Wales</td>
<td align="right">3,169,586</td>
<td align="left">Great Britain</td>
</tr>
<tr class="odd">
<td align="left">Republic of Ireland</td>
<td align="right">4,937,786</td>
<td align="left">Ireland</td>
</tr>
<tr class="even">
<td align="left">Scotland</td>
<td align="right">5,466,000</td>
<td align="left">Great Britain</td>
</tr>
<tr class="odd">
<td align="left">England</td>
<td align="right">56,550,138</td>
<td align="left">Great Britain</td>
</tr>
</tbody>
</table></div>
<div class="try">
<ul>
<li>What geom would you use to plot the population for each of the 5 countries? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_bar</option>
<option value="answer">geom_col</option></select>
</li>
<li>What mapping would you use?
<div id="radio_IVXWBHTFIG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_IVXWBHTFIG" value="answer"><span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_IVXWBHTFIG" value="x"><span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_IVXWBHTFIG" value="x"><span>aes(x = country)</span></label><label><input type="radio" autocomplete="off" name="radio_IVXWBHTFIG" value="x"><span>aes(x = island)</span></label><label><input type="radio" autocomplete="off" name="radio_IVXWBHTFIG" value="x"><span>aes(y = population)</span></label>
</div>
</li>
<li>What geom would you use to plot the number of countries on each island? <select class="webex-select"><option value="blank"></option>
<option value="answer">geom_bar</option>
<option value="x">geom_col</option></select>
</li>
<li>What mapping would you use?
<div id="radio_KQGYPIKVNE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KQGYPIKVNE" value="x"><span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_KQGYPIKVNE" value="x"><span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_KQGYPIKVNE" value="x"><span>aes(x = country)</span></label><label><input type="radio" autocomplete="off" name="radio_KQGYPIKVNE" value="answer"><span>aes(x = island)</span></label><label><input type="radio" autocomplete="off" name="radio_KQGYPIKVNE" value="x"><span>aes(y = population)</span></label>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="one-continuous-variable" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> One Continuous Variable<a class="anchor" aria-label="anchor" href="#one-continuous-variable"><i class="fas fa-link"></i></a>
</h3>
<p>If you have a continuous variable, like the number of seconds callers have to wait, you can use <code>geom_histogram()</code> or <code>geom_density()</code> to show the distribution.</p>
<div id="histogram" class="section level4" number="3.4.2.1">
<h4>
<span class="header-section-number">3.4.2.1</span> Histogram<a class="anchor" aria-label="anchor" href="#histogram"><i class="fas fa-link"></i></a>
</h4>
<p>A histogram splits the data into "bins" along the x-axis and shows the count of how many observations are in each bin along the y-axis.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="03-viz_files/figure-html/unnamed-chunk-15-1.png" alt="Histogram of wait times." width="100%"><p class="caption">
Figure 3.13: Histogram of wait times.
</p>
</div>
<p>You should always set the <code>binwidth</code> or number of <code>bins</code> to something meaningful for your data (otherwise you get that annoying message). You might need to try a few options before you find something that looks good and conveys the meaning of your plot; <code>binwidth = 15</code> seems to work well here.</p>
<p>By default, the bars start <em>centered</em> on 0, so the first bar would include -7.5 to 7.5 seconds, which doesn't make much sense. We can set <code>boundary = 0</code> so that each bar represents increments of 15 seconds <em>starting</em> from 0.</p>
<p>The default style of grey bars is ugly, so you can change that by setting the <code>fill</code> and <code>colour</code>.</p>
<p>We can also set up a base plot object called <code>g</code>, since we'll be making several plots with the same data table with the same mapping, and a custom the x-axis called <code>wait_x</code> so we can reuse it in other plots</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set up base plot </span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span><span class="op">)</span><span class="op">)</span>

<span class="co"># set up x-axis for wait_time</span>
<span class="va">wait_x</span> <span class="op">&lt;-</span> <span class="fu">scale_x_continuous</span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"Wait time (seconds)"</span>,
  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">600</span>, <span class="fl">60</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># style histogram</span>
<span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>boundary <span class="op">=</span> <span class="fl">0</span>, binwidth <span class="op">=</span> <span class="fl">15</span>, 
                 fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="03-viz_files/figure-html/unnamed-chunk-16-1.png" alt="Histogram with custom styles." width="100%"><p class="caption">
Figure 3.14: Histogram with custom styles.
</p>
</div>
</div>
<div id="frequency-plot" class="section level4" number="3.4.2.2">
<h4>
<span class="header-section-number">3.4.2.2</span> Frequency Plot<a class="anchor" aria-label="anchor" href="#frequency-plot"><i class="fas fa-link"></i></a>
</h4>
<p>Rather than plotting each bin as a bar, you can connect a line across the top of each bin using a frequency plot. The function <code>geom_freqpoly()</code> works the same as <code>geom_histogram()</code>, except it can't take a <code>fill</code> argument because it's just a line.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_freqpoly</span><span class="op">(</span>boundary <span class="op">=</span> <span class="fl">0</span>, binwidth <span class="op">=</span> <span class="fl">15</span>, 
                color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="density-plot" class="section level4" number="3.4.2.3">
<h4>
<span class="header-section-number">3.4.2.3</span> Density Plot<a class="anchor" aria-label="anchor" href="#density-plot"><i class="fas fa-link"></i></a>
</h4>
<p>If the distribution is smooth, a density plot is often a better way to show the distribution. A density plot doesn't need the <code>binwidth</code> or <code>boundary</code> arguments because it doesn't split the data into bins, but it can have <code>fill</code>.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"purple"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="test-your-understanding-2" class="section level4" number="3.4.2.4">
<h4>
<span class="header-section-number">3.4.2.4</span> Test your understanding<a class="anchor" aria-label="anchor" href="#test-your-understanding-2"><i class="fas fa-link"></i></a>
</h4>
<p>Imagine you have a table of the <a href="https://population.un.org/wpp/Download/Standard/Population/" target="_blank">population for each country in the world</a> with the columns <code>country</code> and <code>population</code>. We'll just look at the 76 countries with populations of less than a million.</p>
<div class="inline-figure"><img src="03-viz_files/figure-html/test-one-continuous-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="try">
<ul>
<li>What kind of plot is A? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_histogram</option>
<option value="x">geom_freqpoly</option>
<option value="answer">geom_density</option></select>
</li>
<li>What kind of plot is B? <select class="webex-select"><option value="blank"></option>
<option value="answer">geom_histogram</option>
<option value="x">geom_freqpoly</option>
<option value="x">geom_density</option></select>
</li>
<li>What kind of plot is C? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_histogram</option>
<option value="answer">geom_freqpoly</option>
<option value="x">geom_density</option></select>
</li>
<li>How would you set the mapping for these plots?
<div id="radio_PGJXCZGPIK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PGJXCZGPIK" value="x"><span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_PGJXCZGPIK" value="x"><span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_PGJXCZGPIK" value="answer"><span>aes(x = population)</span></label><label><input type="radio" autocomplete="off" name="radio_PGJXCZGPIK" value="x"><span>aes(x = population, y = count)</span></label>
</div>
</li>
<li>What is the <code>binwidth</code> of the histogram? <select class="webex-select"><option value="blank"></option>
<option value="">1</option>
<option value="">100</option>
<option value="answer">100K</option>
<option value="">1M</option></select>
</li>
</ul>
</div>
</div>
</div>
<div id="grouped-continuous-variables" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Grouped Continuous Variables<a class="anchor" aria-label="anchor" href="#grouped-continuous-variables"><i class="fas fa-link"></i></a>
</h3>
<p>There are several ways to compare continuous data across groups. Which you choose depends on what point you are trying to make with the plot.</p>
<div id="subdividing-distributions" class="section level4" number="3.4.3.1">
<h4>
<span class="header-section-number">3.4.3.1</span> Subdividing Distributions<a class="anchor" aria-label="anchor" href="#subdividing-distributions"><i class="fas fa-link"></i></a>
</h4>
<p>You can set the <code>fill</code> aesthetic in the mapping to show what proportion of each bin comes from each category. By default, the categories are positioned stacked on top of each other. The function <code>geom_area()</code> gives a similar effect when <code>stat = "bin"</code>.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set fill by issue category</span>
<span class="va">wait_by_issue</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span>, fill <span class="op">=</span> <span class="va">issue_category</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_by_issue</span><span class="op">)</span>

<span class="co"># stacked histogram</span>
<span class="va">histogram_stack</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>boundary <span class="op">=</span> <span class="fl">0</span>, 
                 binwidth <span class="op">=</span> <span class="fl">15</span>, 
                 color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Stacked Histogram"</span><span class="op">)</span>

<span class="co"># area plot</span>
<span class="va">area_plot</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_area</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"bin"</span>, 
            boundary <span class="op">=</span> <span class="fl">0</span>, 
            binwidth <span class="op">=</span> <span class="fl">15</span>, 
            color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Area"</span><span class="op">)</span>

<span class="co"># put plots together</span>
<span class="va">histogram_stack</span> <span class="op">+</span> <span class="va">area_plot</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_layout.html">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="03-viz_files/figure-html/unnamed-chunk-20-1.png" alt="Stacked histogram versus area plot." width="100%"><p class="caption">
Figure 3.15: Stacked histogram versus area plot.
</p>
</div>
<div class="warning">
<p>Make sure to remove the <code>fill</code> argument from <code>geom_histogram()</code>, or it will overwrite the colours set in the mapping.</p>
</div>
</div>
<div id="comparing-distributions" class="section level4" number="3.4.3.2">
<h4>
<span class="header-section-number">3.4.3.2</span> Comparing Distributions<a class="anchor" aria-label="anchor" href="#comparing-distributions"><i class="fas fa-link"></i></a>
</h4>
<p>If you want to compare more than one distribution, you can set the <code>position</code> argument of <code>geom_histogram()</code> to "dodge" to put the bars for each group next to each other instead of stacking them. However, this can look confusing with several categories. You can use<code>geom_freqpoly()</code> to plot a line connecting the top of each bin.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set both fill and colour to differ by issue category</span>
<span class="va">wait_by_issue</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span>, 
                     fill <span class="op">=</span> <span class="va">issue_category</span>, 
                     colour <span class="op">=</span> <span class="va">issue_category</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_by_issue</span><span class="op">)</span>

<span class="co"># dodged histogram</span>
<span class="va">histogram_dodge</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>boundary <span class="op">=</span> <span class="fl">0</span>, 
                 binwidth <span class="op">=</span> <span class="fl">15</span>, 
                 position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Dodged Histogram"</span><span class="op">)</span>

<span class="co"># frequency plot</span>
<span class="va">freqpoly_plot</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="va">wait_x</span> <span class="op">+</span>
  <span class="fu">geom_freqpoly</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">15</span>, 
                boundary <span class="op">=</span> <span class="fl">0</span>,
                size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span>

<span class="co"># put plots together</span>
<span class="va">histogram_dodge</span> <span class="op">+</span> <span class="va">freqpoly_plot</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_layout.html">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="03-viz_files/figure-html/unnamed-chunk-21-1.png" alt="Different ways to plot the distribution of a continuous variable for multiple groups." width="100%"><p class="caption">
Figure 3.16: Different ways to plot the distribution of a continuous variable for multiple groups.
</p>
</div>
</div>
<div id="violin-plot" class="section level4" number="3.4.3.3">
<h4>
<span class="header-section-number">3.4.3.3</span> Violin Plot<a class="anchor" aria-label="anchor" href="#violin-plot"><i class="fas fa-link"></i></a>
</h4>
<p>Another way to compare groups of continuous variables is the violin plot. This is like a density plot, but rotated 90 degrees and mirrored.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wait_by_issue</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">issue_category</span>, 
                     y <span class="op">=</span> <span class="va">wait_time</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_by_issue</span><span class="op">)</span>

<span class="va">g</span> <span class="op">+</span> <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:violin-plot"></span>
<img src="03-viz_files/figure-html/violin-plot-1.png" alt="Basic violin plot." width="100%"><p class="caption">
Figure 3.17: Basic violin plot.
</p>
</div>
</div>
<div id="boxplot" class="section level4" number="3.4.3.4">
<h4>
<span class="header-section-number">3.4.3.4</span> Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"><i class="fas fa-link"></i></a>
</h4>
<p>Boxplots serve a similar purpose to violin plots (without the giggles from the back row). They don't show you the shape of the distribution, but rather some statistics about it. The middle line represents the <a class="glossary" target="_blank" title="The middle number in a distribution where half of the values are larger and half are smaller." href="https://psyteachr.github.io/glossary/m#median">median</a>; half the data are above this line and half below it. The box encloses the 25th to 75th percentiles of the data, so 50% of the data falls inside the box. The "whiskers" extending above and below the box extend 1.5 times the height of the box, although you can change this with the <code>coef</code> argument. The points show <a class="glossary" target="_blank" title="A data point that is extremely distant from most of the other data points" href="https://psyteachr.github.io/glossary/o#outlier">outliers</a> -- individual data points that fall outside of this range.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:box-plot"></span>
<img src="03-viz_files/figure-html/box-plot-1.png" alt="Basic boxplot." width="100%"><p class="caption">
Figure 3.18: Basic boxplot.
</p>
</div>
</div>
<div id="combo-plots" class="section level4" number="3.4.3.5">
<h4>
<span class="header-section-number">3.4.3.5</span> Combo Plots<a class="anchor" aria-label="anchor" href="#combo-plots"><i class="fas fa-link"></i></a>
</h4>
<p>Violin plots are frequently layered with other geoms that represent the mean or median values in the data.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add fill and colour to the mapping</span>
<span class="va">wait_by_issue</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">issue_category</span>, 
                     y <span class="op">=</span> <span class="va">wait_time</span>,
                     fill <span class="op">=</span> <span class="va">issue_category</span>,
                     colour <span class="op">=</span> <span class="va">issue_category</span><span class="op">)</span>

<span class="co"># set up default plot</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_by_issue</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Issue Category"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Wait Time (seconds)"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">600</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, colour <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="co"># remove legends</span>

<span class="va">median</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu">geom_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span>, draw_quantiles <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Median line (default trim)"</span><span class="op">)</span>

<span class="va">mean_point</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu">geom_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span>, trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> 
 <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Mean point (no trim)"</span><span class="op">)</span>
  
<span class="va">violinbox</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu">geom_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, 
               fill <span class="op">=</span> <span class="st">"white"</span>, 
               alpha <span class="op">=</span> <span class="fl">0.75</span>, 
               outlier.alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"ViolinBox"</span><span class="op">)</span>

<span class="va">median</span> <span class="op">+</span> <span class="va">mean_point</span> <span class="op">+</span> <span class="va">violinbox</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:violin-combos"></span>
<img src="03-viz_files/figure-html/violin-combos-1.png" alt="Violin plots combined with different methods to represent means and medians." width="100%"><p class="caption">
Figure 3.19: Violin plots combined with different methods to represent means and medians.
</p>
</div>
<div class="dangerous">
<p>The column plot below demonstrates just how misleading this common type of plot is. It communicates the mean value for each category, but the bars hide the distribution of the actual data. You can't tell if most wait times are close to 3 minutes, or spread from 0 to 6 minutes, or if the vast majority are less than 2 minutes, but the mean is pulled up by some very high outliers.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># stat_summary applies a function ("mean") to the data </span>
<span class="co"># and plots the results using the specified geom ("col")</span>

<span class="va">g</span> <span class="op">+</span> <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"col"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># sets the y-axis limits automatically</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:col-plot-bad"></span>
<img src="03-viz_files/figure-html/col-plot-bad-1.png" alt="Don't plot continuous data with column plots." width="100%"><p class="caption">
Figure 3.20: Don't plot continuous data with column plots.
</p>
</div>
</div>
</div>
<div id="test-your-understanding-3" class="section level4" number="3.4.3.6">
<h4>
<span class="header-section-number">3.4.3.6</span> Test your understanding<a class="anchor" aria-label="anchor" href="#test-your-understanding-3"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-figure"><img src="03-viz_files/figure-html/test-grouped-continuous-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="try">
<ul>
<li>How would you create plot A? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_box()</option>
<option value="x">geom_boxplot()</option>
<option value="answer">geom_violin()</option>
<option value="x">geom_violinplot()</option></select>
</li>
<li>How would you create plot B? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_box()</option>
<option value="answer">geom_boxplot()</option>
<option value="x">geom_violin()</option>
<option value="x">geom_violinplot()</option></select>
</li>
<li>What do the horizontal lines in the middle of the shapes represent? <select class="webex-select"><option value="blank"></option>
<option value="x">mean</option>
<option value="answer">median</option>
<option value="x">mode</option></select>
</li>
<li>What does the mapping look like for both plots?
<div id="radio_XWEPEKHHCN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XWEPEKHHCN" value="x"><span>aes(x = employee_id, y = call_time, colour = employee_id)</span></label><label><input type="radio" autocomplete="off" name="radio_XWEPEKHHCN" value="x"><span>aes(x = employee_id, y = call_time, colour = call_time)</span></label><label><input type="radio" autocomplete="off" name="radio_XWEPEKHHCN" value="answer"><span>aes(x = employee_id, y = call_time, fill = employee_id)</span></label><label><input type="radio" autocomplete="off" name="radio_XWEPEKHHCN" value="x"><span>aes(x = employee_id, y = call_time, fill = call_time)</span></label>
</div>
</li>
<li>Which employee tends to have the longest calls? <select class="webex-select"><option value="blank"></option>
<option value="x">e01</option>
<option value="x">e02</option>
<option value="x">e03</option>
<option value="answer">e04</option>
<option value="x">e05</option>
<option value="x">e06</option>
<option value="x">e07</option>
<option value="x">e08</option>
<option value="x">e09</option>
<option value="x">e10</option></select>
</li>
<li>Which employee has the record longest call? <select class="webex-select"><option value="blank"></option>
<option value="x">e01</option>
<option value="x">e02</option>
<option value="x">e03</option>
<option value="x">e04</option>
<option value="x">e05</option>
<option value="x">e06</option>
<option value="answer">e07</option>
<option value="x">e08</option>
<option value="x">e09</option>
<option value="x">e10</option></select>
</li>
</ul>
</div>
</div>
</div>
<div id="two-continuous-variables" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Two Continuous Variables<a class="anchor" aria-label="anchor" href="#two-continuous-variables"><i class="fas fa-link"></i></a>
</h3>
<p>When you want to see how two continuous variables are related, set one as the x-axis and the other as the y-axis. Usually, if one variable causes the other, you plot the cause on the x-axis and the effect on the y-axis. Here, we want to see if longer wait times cause the calls to be longer.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wait_by_call</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wait_time</span>,
                    y <span class="op">=</span> <span class="va">call_time</span><span class="op">)</span>

<span class="co"># assign the base plot to a variable to use later</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">wait_by_call</span><span class="op">)</span></code></pre></div>
<div id="scatterplot" class="section level4" number="3.4.4.1">
<h4>
<span class="header-section-number">3.4.4.1</span> Scatterplot<a class="anchor" aria-label="anchor" href="#scatterplot"><i class="fas fa-link"></i></a>
</h4>
<p>The function to create a scatterplot is called <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:demo-point"></span>
<img src="03-viz_files/figure-html/demo-point-1.png" alt="Scatterplot with geom_point()." width="100%"><p class="caption">
Figure 3.21: Scatterplot with geom_point().
</p>
</div>
</div>
<div id="trendlines" class="section level4" number="3.4.4.2">
<h4>
<span class="header-section-number">3.4.4.2</span> Trendlines<a class="anchor" aria-label="anchor" href="#trendlines"><i class="fas fa-link"></i></a>
</h4>
<p>In Figure <a href="viz.html#fig:layers">3.2</a>, we emphasised the relationship between wait time and call time with a trendline created by <code>geom_smooth()</code> using the argument <code>method = lm</code> ("lm" stands for "linear model"). You can also set <code>method = loess</code> to visualise a non-linear relationship.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lm_plot</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"method = lm"</span><span class="op">)</span>

<span class="va">loess_plot</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"method = loess"</span><span class="op">)</span>

<span class="va">lm_plot</span> <span class="op">+</span> <span class="va">loess_plot</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="03-viz_files/figure-html/unnamed-chunk-23-1.png" alt="Different ways to show the relationship between two continuous variables." width="100%"><p class="caption">
Figure 3.22: Different ways to show the relationship between two continuous variables.
</p>
</div>
<div class="warning">
<p>If there isn't much data at the extremes of the x-axis, the curve can be very uncertain. This is represented by the wider shaded area, which means that the true relationship might be anywhere within that area.</p>
</div>
</div>
<div id="dates" class="section level4" number="3.4.4.3">
<h4>
<span class="header-section-number">3.4.4.3</span> Dates<a class="anchor" aria-label="anchor" href="#dates"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>call_start</code> column contains both a date and a time, so use the <code><a href="https://rdrr.io/pkg/lubridate/man/date.html">date()</a></code> function from <code class="package">lubridate</code> to convert it to just a date. We'll need it in this format to be able to transform the x-axis below.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">satisfaction_by_date</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/date.html">date</a></span><span class="op">(</span><span class="va">call_start</span><span class="op">)</span>,
                            y <span class="op">=</span> <span class="va">satisfaction</span><span class="op">)</span>

<span class="co"># assign the base plot to a variable to use later</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">satisfaction_by_date</span><span class="op">)</span>

<span class="va">g</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>We can use <code>scale_x_date()</code> to set the <code>date_breaks</code> to be "1 month" apart. The <code>date_labels</code> use a code for different date formats, which you can see in the help for <code><a href="https://rdrr.io/r/base/strptime.html">?strptime</a></code>. For example, you can change the dates to a format like "2020/01/31" with the formatting string <code>"%Y/%m/%d"</code>.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>,  formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_date</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>,
               date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, 
               date_labels <span class="op">=</span> <span class="st">"%b"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Caller Satisfaction"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"2020 Caller Satisfaction"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="try">
<p>It looks like customer satisfaction declined across the year, but is this change meaningful? See what the plot looks like when the y-axis spans the full range of possible satisfaction values from 1 to 5. You can also plot the individual data points to emphasise the range of values.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> 
  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span>, height <span class="op">=</span> <span class="fl">.1</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>,  formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_date</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>,
               date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, 
               date_labels <span class="op">=</span> <span class="st">"%b"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Caller Satisfaction"</span>,
                     breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"2020 Caller Satisfaction"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-viz_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
</div>
<div id="ordinal-variables" class="section level3" number="3.4.5">
<h3>
<span class="header-section-number">3.4.5</span> Ordinal Variables<a class="anchor" aria-label="anchor" href="#ordinal-variables"><i class="fas fa-link"></i></a>
</h3>
<p>When you have a limited range of numeric values, such as an ordinal rating scale, sometimes overlapping data makes it difficult to see what is going on in a point plot. In this section, we'll explore a few options for dealing with this.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sat_call</span> <span class="op">&lt;-</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">call_time</span>, y <span class="op">=</span> <span class="va">satisfaction</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="va">sat_call</span><span class="op">)</span>

<span class="va">g</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:over-plot"></span>
<img src="03-viz_files/figure-html/over-plot-1.png" alt="Overlapping data." width="100%"><p class="caption">
Figure 3.23: Overlapping data.
</p>
</div>
<div id="jitter-plot" class="section level4" number="3.4.5.1">
<h4>
<span class="header-section-number">3.4.5.1</span> Jitter Plot<a class="anchor" aria-label="anchor" href="#jitter-plot"><i class="fas fa-link"></i></a>
</h4>
<p>You can use <code>geom_jitter()</code> to move the points around a bit to make them easier to see. You can also set alpha transparency. Here, the x-axis is continuous, so there is no need to jitter the <code>width</code>, but the y-axis is ordinal categories, so the <code>height</code> is jittered between -0.2 and +0.2 away from the true y-value.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">+</span> <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span>, height <span class="op">=</span> <span class="fl">.2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:jitter-plot"></span>
<img src="03-viz_files/figure-html/jitter-plot-1.png" alt="Jitter plot." width="100%"><p class="caption">
Figure 3.24: Jitter plot.
</p>
</div>
</div>
<div id="facets" class="section level4" number="3.4.5.2">
<h4>
<span class="header-section-number">3.4.5.2</span> Facets<a class="anchor" aria-label="anchor" href="#facets"><i class="fas fa-link"></i></a>
</h4>
<p>Alternatively, you can use <code>facet_wrap()</code> to create a separate plot for each level of satisfaction.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey_data</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">call_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">10</span>, 
                 boundary <span class="op">=</span> <span class="fl">0</span>, 
                 fill <span class="op">=</span> <span class="st">"dodgerblue"</span>, 
                 color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">satisfaction</span>, ncol <span class="op">=</span> <span class="fl">1</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Call Time (seconds)"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">600</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fact-plot"></span>
<img src="03-viz_files/figure-html/fact-plot-1.png" alt="A histogram with facets." width="100%"><p class="caption">
Figure 3.25: A histogram with facets.
</p>
</div>
<div class="info">
<p>These are not, by any means, all the plot types that you can make in R. This chapter just gave you a basic overview, and we will go into more detail in Chapter <a href="custom.html#custom">9</a>. The <a href="viz.html#resources-viz">further resources</a> section at the end of this chapter lists many resources, but the <a href="http://www.r-graph-gallery.com/" target="_blank">R Graph Gallery</a> is an especially useful one to get inspiration for the kinds of beautiful plots you can make in R.</p>
</div>
</div>
</div>
</div>
<div id="glossary-viz" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Glossary<a class="anchor" aria-label="anchor" href="#glossary-viz"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
definition
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/a.html#argument" class="glossary" target="_blank">argument</a>
</td>
<td style="text-align:left;">
A variable that provides input to a function.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/c.html#categorical" class="glossary" target="_blank">categorical</a>
</td>
<td style="text-align:left;">
Data that can only take certain values, such as types of pet.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/c.html#character" class="glossary" target="_blank">character</a>
</td>
<td style="text-align:left;">
A data type representing strings of text.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/c.html#continuous" class="glossary" target="_blank">continuous</a>
</td>
<td style="text-align:left;">
Data that can take on any values between other existing values.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/d.html#data-type" class="glossary" target="_blank">data type</a>
</td>
<td style="text-align:left;">
The kind of data represented by an object.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/d.html#double" class="glossary" target="_blank">double</a>
</td>
<td style="text-align:left;">
A data type representing a real decimal number
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/f.html#factor" class="glossary" target="_blank">factor</a>
</td>
<td style="text-align:left;">
A data type where a specific set of values are stored with labels; An explanatory variable manipulated by the experimenter
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/g.html#geom" class="glossary" target="_blank">geom</a>
</td>
<td style="text-align:left;">
The geometric style in which data are displayed, such as boxplot, density, or histogram.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/i.html#integer" class="glossary" target="_blank">integer</a>
</td>
<td style="text-align:left;">
A data type representing whole numbers.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/l.html#likert" class="glossary" target="_blank">likert</a>
</td>
<td style="text-align:left;">
A rating scale with a small number of discrete points in order
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/l.html#logical" class="glossary" target="_blank">logical</a>
</td>
<td style="text-align:left;">
A data type representing TRUE or FALSE values.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/m.html#median" class="glossary" target="_blank">median</a>
</td>
<td style="text-align:left;">
The middle number in a distribution where half of the values are larger and half are smaller.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/n.html#nominal" class="glossary" target="_blank">nominal</a>
</td>
<td style="text-align:left;">
Categorical variables that don't have an inherent order, such as types of animal.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/n.html#numeric" class="glossary" target="_blank">numeric</a>
</td>
<td style="text-align:left;">
A data type representing a real decimal number or integer.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/o.html#object" class="glossary" target="_blank">object</a>
</td>
<td style="text-align:left;">
A word that identifies and stores the value of some data for later use.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/o.html#observation" class="glossary" target="_blank">observation</a>
</td>
<td style="text-align:left;">
All of the data about a single trial or question.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/o.html#ordinal" class="glossary" target="_blank">ordinal</a>
</td>
<td style="text-align:left;">
Discrete variables that have an inherent order, such as number of legs
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/o.html#outlier" class="glossary" target="_blank">outlier</a>
</td>
<td style="text-align:left;">
A data point that is extremely distant from most of the other data points
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/s.html#string" class="glossary" target="_blank">string</a>
</td>
<td style="text-align:left;">
A piece of text inside of quotes.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/v.html#value" class="glossary" target="_blank">value</a>
</td>
<td style="text-align:left;">
A single number or piece of data.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/v.html#variable" class="glossary" target="_blank">variable</a>
</td>
<td style="text-align:left;">
A word that identifies and stores the value of some data for later use.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/v.html#vector" class="glossary" target="_blank">vector</a>
</td>
<td style="text-align:left;">
A type of data structure that collects values with the same data type, like T/F values, numbers, or strings.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="resources-viz" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Further Resources<a class="anchor" aria-label="anchor" href="#resources-viz"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<a href="https://psyteachr.github.io/introdataviz/">Data visualisation using R, for researchers who don't use R</a> <span class="citation">(<a href="references.html#ref-nordmann_2021" role="doc-biblioref">Nordmann et al., 2021</a>)</span>
</li>
<li>
<a href="http://r4ds.had.co.nz/data-visualisation.html">Chapter 3: Data Visualisation</a> of <em>R for Data Science</em>
</li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">ggplot2 cheat sheet</a></li>
<li><a href="https://ggplot2.tidyverse.org/articles/">ggplot2 FAQs</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/">ggplot2 documentation</a></li>
<li>
<a href="https://psyteachr.github.io/hack-your-data/">Hack Your Data Beautiful</a> workshop by University of Glasgow postgraduate students</li>
<li>
<a href="http://r4ds.had.co.nz/graphics-for-communication.html">Chapter 28: Graphics for communication</a> of <em>R for Data Science</em>
</li>
</ul>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><div class="chapter-nav">
<div class="prev"><a href="reports.html"><span class="header-section-number">2</span> Reports with R Markdown</a></div>
<div class="next"><a href="data.html"><span class="header-section-number">4</span> Data Import</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#viz"><span class="header-section-number">3</span> Basic Data Visualisation</a></li>
<li><a class="nav-link" href="#ilo-viz"><span class="header-section-number">3.1</span> Intended Learning Outcomes</a></li>
<li>
<a class="nav-link" href="#variable-types"><span class="header-section-number">3.2</span> Variable Types</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#continuous"><span class="header-section-number">3.2.1</span> Continuous</a></li>
<li><a class="nav-link" href="#categorical"><span class="header-section-number">3.2.2</span> Categorical</a></li>
<li><a class="nav-link" href="#dates-and-times"><span class="header-section-number">3.2.3</span> Dates and Times</a></li>
<li><a class="nav-link" href="#test-your-understanding"><span class="header-section-number">3.2.4</span> Test your understanding</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#building-plots"><span class="header-section-number">3.3</span> Building Plots</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#layered-plots"><span class="header-section-number">3.3.1</span> Layered Plots</a></li>
<li><a class="nav-link" href="#loading-data-1"><span class="header-section-number">3.3.2</span> Loading Data</a></li>
<li><a class="nav-link" href="#plot-setup"><span class="header-section-number">3.3.3</span> Plot setup</a></li>
<li><a class="nav-link" href="#mapping"><span class="header-section-number">3.3.4</span> Mapping</a></li>
<li><a class="nav-link" href="#geoms"><span class="header-section-number">3.3.5</span> Geoms</a></li>
<li><a class="nav-link" href="#multiple-geoms"><span class="header-section-number">3.3.6</span> Multiple Geoms</a></li>
<li><a class="nav-link" href="#styling-geoms"><span class="header-section-number">3.3.7</span> Styling Geoms</a></li>
<li><a class="nav-link" href="#format-axes"><span class="header-section-number">3.3.8</span> Format Axes</a></li>
<li><a class="nav-link" href="#axis-limits"><span class="header-section-number">3.3.9</span> Axis Limits</a></li>
<li><a class="nav-link" href="#themes"><span class="header-section-number">3.3.10</span> Themes</a></li>
<li><a class="nav-link" href="#theme-tweaks"><span class="header-section-number">3.3.11</span> Theme Tweaks</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#appropriate-plots"><span class="header-section-number">3.4</span> Appropriate Plots</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#counting-categories"><span class="header-section-number">3.4.1</span> Counting Categories</a></li>
<li><a class="nav-link" href="#one-continuous-variable"><span class="header-section-number">3.4.2</span> One Continuous Variable</a></li>
<li><a class="nav-link" href="#grouped-continuous-variables"><span class="header-section-number">3.4.3</span> Grouped Continuous Variables</a></li>
<li><a class="nav-link" href="#two-continuous-variables"><span class="header-section-number">3.4.4</span> Two Continuous Variables</a></li>
<li><a class="nav-link" href="#ordinal-variables"><span class="header-section-number">3.4.5</span> Ordinal Variables</a></li>
</ul>
</li>
<li><a class="nav-link" href="#glossary-viz"><span class="header-section-number">3.5</span> Glossary</a></li>
<li><a class="nav-link" href="#resources-viz"><span class="header-section-number">3.6</span> Further Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/ads-v1/blob/master/book/03-viz.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/ads-v1/edit/master/book/03-viz.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Applied Data Skills</strong>: Processing &amp; Presenting Data" was written by Emily Nordmann and Lisa DeBruine. It was last built on 2021-11-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
